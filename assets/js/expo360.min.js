function fnFixPng(e){var t=navigator.appVersion;if(navigator.platform=="Win32"&&navigator.appName=="Microsoft Internet Explorer"&&window.attachEvent&&parseInt($.browser.version,10)<10){var n=e.css("background-image");var r=n.substring(5,n.length-2);e.css("filter","progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+r+"', sizingMethod='scale')");e.css("background-image","url(x.gif)")}}function buttonsClass(e,t,n,r,i,s){var o=jQuery(e);var u=jQuery('<span class="hover"></span>');o.append(u);o.css("background-image","url("+t+")");u.css("background-image","url("+n+")");o.css({"background-image":"url("+t+")","background-repeat":"no-repeat","background-position":"center",width:r+"px",overflow:"hidden",height:i+"px"});u.css({"background-image":"url("+n+")","background-repeat":"no-repeat","background-position":"center",width:r+"px",height:i+"px",position:"absolute",overflow:"hidden",top:0,left:0});fnFixPng(o);fnFixPng(u);u.css("opacity",0);o.hover(function(){if(!o.hasClass("disabled"))u.stop().fadeTo(s,1)},function(){if(!o.hasClass("active"))u.stop().fadeTo(s,0)})}!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(e){function t(t){var o=t||window.event,u=a.call(arguments,1),f=0,h=0,p=0,v=0,m=0,g=0;if(t=e.event.fix(o),t.type="mousewheel","detail"in o&&(p=-1*o.detail),"wheelDelta"in o&&(p=o.wheelDelta),"wheelDeltaY"in o&&(p=o.wheelDeltaY),"wheelDeltaX"in o&&(h=-1*o.wheelDeltaX),"axis"in o&&o.axis===o.HORIZONTAL_AXIS&&(h=-1*p,p=0),f=0===p?h:p,"deltaY"in o&&(p=-1*o.deltaY,f=p),"deltaX"in o&&(h=o.deltaX,0===p&&(f=-1*h)),0!==p||0!==h){if(1===o.deltaMode){var y=e.data(this,"mousewheel-line-height");f*=y,p*=y,h*=y}else if(2===o.deltaMode){var b=e.data(this,"mousewheel-page-height");f*=b,p*=b,h*=b}if(v=Math.max(Math.abs(p),Math.abs(h)),(!s||s>v)&&(s=v,r(o,v)&&(s/=40)),r(o,v)&&(f/=40,h/=40,p/=40),f=Math[f>=1?"floor":"ceil"](f/s),h=Math[h>=1?"floor":"ceil"](h/s),p=Math[p>=1?"floor":"ceil"](p/s),l.settings.normalizeOffset&&this.getBoundingClientRect){var w=this.getBoundingClientRect();m=t.clientX-w.left,g=t.clientY-w.top}return t.deltaX=h,t.deltaY=p,t.deltaFactor=s,t.offsetX=m,t.offsetY=g,t.deltaMode=0,u.unshift(t,f,h,p),i&&clearTimeout(i),i=setTimeout(n,200),(e.event.dispatch||e.event.handle).apply(this,u)}}function n(){s=null}function r(e,t){return l.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120===0}var i,s,o=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],u="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],a=Array.prototype.slice;if(e.event.fixHooks)for(var f=o.length;f;)e.event.fixHooks[o[--f]]=e.event.mouseHooks;var l=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var n=u.length;n;)this.addEventListener(u[--n],t,!1);else this.onmousewheel=t;e.data(this,"mousewheel-line-height",l.getLineHeight(this)),e.data(this,"mousewheel-page-height",l.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var n=u.length;n;)this.removeEventListener(u[--n],t,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var n=e(t),r=n["offsetParent"in e.fn?"offsetParent":"parent"]();return r.length||(r=e("body")),parseInt(r.css("fontSize"),10)||parseInt(n.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})});eval(function(e){for(var t="",n=0,r=function(e,t){for(var n=0,r=0;r<t;r++){n*=96;var i=e.charCodeAt(r);if(i>=32&&i<=127){n+=i-32}}return n};n<e.length;){if(e.charAt(n)!="`")t+=e.charAt(n++);else{if(e.charAt(n+1)!="`"){var i=r(e.charAt(n+3),1)+5;t+=t.substr(t.length-r(e.substr(n+1,2),2)-i,i);n+=4}else{t+="`";n+=2}}}return t}('(function (n,l,o,s){var D="vmousecancel",A=true,E=false,F="virtualMouseBindings",J` 0$TouchID",X` d#over ` q!down` $"move` /"up vclick` ?"out` I"`!@".split(" "),Y="clientX ` "!Y pageX pageY screenX ` "!Y` N(T=n.event.`"? Hooks?n` ",.props:[],O` H$` . .concat(T),G={},u=0,v=0,U=0,w=E,Q=[],I=E,N=E,P="addEventListener" in o,R=n(o),t1=1,d0=0,r0;n.`#r!={moveDistanceThreshold:10,`"} ` %0resetTimerDuration:1500};`$}$a0(a){while (a&&typeof a.original`!c !=="undefined"){a=` 2*;}return a;}`%y$Y0(a,b`%z!c=a.type,d,f,g,h,i,j,k,m,q;a=n.`"i (a);` @!=b;d` r,f`#f);if (c.search(/^(`&z |`%j )/)>-1){f=O;}if (d){for (k=f.length,h;k;){h=f[--k];a[h]=d[h];}` M ` p%`\'r (down|up)` {!` { &&!a.which){` ""=1`!*!`!M&touch/)!==-1){g=a0(d);c=g.` 5 es;i=g.changed`(? es;j=(c&&c`!e")?c[0]:((i&&i` +$i[0]:s)`"c j`"9"m=0,q=Y`"=";m<q;m++){h=Y[m`">"j`"?!`$>/s`%I var b={},c,d;`%S#){c=n.data(a,F);`#J d in c){`$& [d]){b[d]=b.hasV`*P!Binding=A;}}a=a.parentNode`%k$b`%i&X`%h\'`!$4`%6 &&(!b||c[b])){`&V%` o2null`&r&B(){N=E`\'$&r` - A`\'6&P0(){d0=0;Q`%o"=0;I=E;r()`\']&Q0(){B` &(u0(){t0();u=`)<"out(`).$(){u=0;P0();},`*<#.`)^-` |\'t0(`#e!u){clear` o#u);u=0;}`)1%S(a,b,c`)6!d`(F `&, [a])||(!c&&X0(b.target,a))){d=Y0(b,a);n` 1$).trigger(d)`*;$d`*9&C`%g&`%W#` n#J`&v!!I&&(!d0||d0!==b)`$w"=S("v"+`*L!,a`$o"`&&".isDefaultPr`*P ed()){a.p` )!` 6"()`)(#isPropag`#1 Stopp` J#stop` 1&` G\'Immediate` @7` 1/();}}`#e&i`(N&a0(a)`*5#`(_ if (b&&b`%}#==1){c=`#!#;d=s0(c`*$!d`(J-`&_ t1++;`):"c,J,d0);`&< Q0();w=E;var f`!0)[0];v=f.pageX;U` #"Y;S("`&L!over",a,d)` *%down` -"`"7\'o`%% if (N`)%$`#w!!w){S(D,a,s0`%5$));}w=A;u`\'^ `*7$h` Q0`#&.[0],c=w,d=`(5$moveDistanceThreshold,f=`!*\';w=w||(Math.abs(b`"V!-v)>d||` (*Y-U)>d`\' !w&&!c`" #f);}`"{$move"` /!`!~*D`"^0r()`$\' b`!L(,c`#l%up",a,b`(8"w`)_"`(+ click` 3&d&&d`\'u2c`&C"changedT`%)%Q.push({`&_ ID:d0,x:c.clientX,y` #$Y});I=A;}`"D%out`!V"w=E`$N+v`*;.,F),c`\']!){for (c in b`*#!b[c]`%f$A;}}}`%t"E`%J&R0(){`(c%Z0(f`(g!g="`(c start",h=f.substr(1);`&]"{setup:`)B$(a,`!5"!v0(this)){`(R"this,F,{})`&N!c`!~#` 3!);c[f]=A;G[f]=(G[f]||0)+1`)} ` 0 `)v R.bind(h,C0);}n` !` ,#R0`*#!P){G[g` b g` Y)g` Y)g,i0` W"`"H!end",D` &)`&_!h` @$scroll",o0`)a ,teardown`"X+--G[f]`&C!G[f]){R.un`!s\'`!e"--G[g` @$g` =\'`![!` O"`!?+` *(`!q$` E#`!Y)`#l"`$/!`*5 `#p(`\'k ){d[f]=E;}c`!_%`#L#`$g&c.r`)U Data(F`"` ;}`&Z var p0=0;p0<X.length;p0++){n.`([ .special[X[p0]]=Z0(` % `"d%o.addEventListener("`)T"`&>&`(##Q` ",c=`*H#,d,f,g,h,i,j`(5#d=a`)<#;f` #$Y;r0=n.`)8!.`*[ DistanceThreshold;g=c;while (g`("h=0;h<b;h++){i=Q[h];j=0`)E (g===c&&Math.abs(i.x-d)<r0` \'(y-f)<r0)||`*&"g,J)===i.`)1 ID){a.pr`#/ Default();a.stopPropagation(`)C$;}}g=g.parentNode`&w A);}})(jQuery,window,document);'));jQuery(document).ready(function(e){function v(t,n){if(!t.hasClass("disabled")){t.addClass("disabled");t.stop().fadeTo(300,n);e("span",t).stop().fadeTo(300,0);t.css("cursor","default")}}function m(e){if(e.hasClass("disabled")){e.removeClass("disabled");e.stop().fadeTo(300,1);e.css("cursor","pointer")}}function g(t,n){var r=t.offset();var i=e(".tooltip[rel='"+n+"']");var s=r.top-i.outerHeight()-3;var o=r.left-i.width()/2+parseInt(t.width(),10)/4-1;i.css({top:s,left:o});return i}function y(t,n){var r=e(".tooltip[rel='"+t+"'] span");r.text(n)}function b(){e(document).unbind(s);e(document).unbind(o)}function w(e,t,n,r){e.css({"font-family":t,color:n,"font-size":r+"px"})}function E(e,t){e.css({"-webkit-border-radius":t,"-moz-border-radius":t,"-o-border-radius":t,"border-radius":t})}function S(e,t,n,r){if(n!="0"&&n!=0){var i=T(t,n);var s=N(t,n);e.css({"background-color":t,filter:i,background:s})}if(r!="none")e.css({"background-image":"url("+r+")","background-repeat":"repeat"})}function x(e){if(r)e.get(0).onselectstart=function(){return false};e.get(0).onmousedown=function(e){e.preventDefault()}}function T(e,t){var n=parseInt(parseFloat(t,10)*255).toString(16);var r="progid:DXImageTransform.Microsoft.gradient(startColorstr=#"+n+e.substring(1,3)+e.substring(3,5)+e.substring(5,7)+",endColorstr=#"+n+e.substring(1,3)+e.substring(3,5)+e.substring(5,7)+")";return r}function N(e,t){var n="rgba("+e.substring(1,3)+", "+e.substring(3,5)+", "+e.substring(5,7)+", "+t+")";return n}var t=e("body");var n=navigator.userAgent.match(/(iPad)|(iPhone)|(iPod)|(android)|(webOS)/i);var r=jQuery.browser.msie;var i="mousedown";var s="mousemove";var o="mouseup";var u="mouseover";var a="mouseout";var f="click";var l=10;if(n){l=15;i="vmousedown";s="vmousemove";o="vmouseup";u="vmouseover";a="vmouseout";f="vclick"}var c=0,h,p;var d=function(t){this.xml=t.xml;this.parameters=t;this.singleImage=false;this.focusable=true;this.oldImage=-1,this.currentImage=0,this.numImages;this.degrees=0,this.speedDeg=0,this.speedInc=0,this.speedDegDefault=0;this.dragging=false,this.panning=false;this.positionClickedX,this.degWhenClicked;this.currentX,this.oldDif;this.buttonsDisabledAlpha=.3;this.viewLeft=0,this.viewTop=0;this.currentWidth,this.currentHeight;this.zoomWhenPad=1;this.ease=5,this.inertia=1;this.mouse_wheel_function="zoom",this.mouse_wheel_speed=1;this.draggingZoomSlider=false,this.draggingPlaybackSlider=false;this.sliderWidth=0,this.playbackSliderWidth=0;this.maxZoom,this.minZoom,this.zoomEase,this.zoomSpeed,this.zoom=1,this.zoomCurrent=1,this.focusTimer;this.focused=false;this.autoplay=false,this.autoplaySpeed;this.mode="rotate";this.reverse=false;this.width,this.height;this.iniWidth,this.iniHeight;this.posX=0,this.posY=0;this.include_zoom_window=false;this.zoom_window_width,this.zoom_window_height,this.zoomWindowEnabled=true;this.viewLeftCurrent=0,this.viewTopCurrent=0,this.paddingEase=5;this.imagesPath,this.imagesBigPath,this.hotspotsImagesPath,this.grab_hand_cursor=false,this.loading_text;this.imagesSrc=Array(),this.hotspots=Array(),this.hotspotsButtons=Array(),this.hotspotsTooltips=Array(),this.$hotspotsSmall;this.images=Array(),this.zoom_window_images=Array();this.controls=Array(),this.controlsExtras=Array();this.include_tooltips=false;this.panel_options=Object();this.loading_options=new Object;this.tooltips_options=new Object;this.zoom_window_options=new Object;this.tooltips_texts=new Object;this.$bigImage=null;this.$zoomSlider=null,this.$zoomMinus=null,this.$zoomPlus=null,this.$playbackSlider=null,this.$panButton=null,this.$rotateButton=null;this.$root=e(t.where);this.$main=e("<div></div>");this.$view=e("<div></div>");this.$imagesHolder=e("<div></div>");this.$bigContent=e("<div></div>");this.$panel=e("<div></div>");this.$loader=e("<div></div>");this.$zoomWindow,this.$zoomWindowBox,this.$zoomClickable;this.$loadingText=e("<div></div>");this.$autoplayPlay,this.$autoplayPause;this.sliderFrom,this.sliderTo,this.sliderX;this.posIniX,this.posIniY;this.zoomBtnInterval=0;this.goToDegree=false,this.showedHotspots=false,this.focusedNum=-1,this.smallTweenTime=200;this.currentHotspots=Array(),this.currentHotspotsTooltips=Array()};d.prototype={_this:this,loadXml:function(){var t=this;e.ajax({type:"GET",url:t.xml,dataType:"xml",success:function(e){t.parseXml(e)}})},parseXml:function(t){var n=this;var r=e(t).find("ProductViewer");this.width=parseInt(e(r).find("viewWidth").text(),10);this.height=parseInt(e(r).find("viewHeight").text(),10);this.ease=parseFloat(e(r).find("ease").text(),10);this.paddingEase=parseFloat(e(r).find("padding_ease").text(),10);this.inertia=parseFloat(e(r).find("inertia").text(),10);this.mouse_wheel_function=e(r).find("mouse_wheel_function").text();this.mouse_wheel_speed=parseFloat(e(r).find("mouse_wheel_speed").text(),10);this.zoomSpeed=parseFloat(e(r).find("zoomSpeed").text(),10);this.zoomEase=parseInt(e(r).find("zoomEase").text(),10);if(e(r).find("maxZoom").text()=="auto")this.maxZoom="auto";else this.maxZoom=parseFloat(e(r).find("maxZoom").text(),10);if(e(r).find("reverse").text()=="true")this.reverse=true;if(e(r).find("autoplay").text()=="true")this.autoplay=true;if(e(r).find("grab_hand_cursor").text()=="true")this.grab_hand_cursor=true;this.autoplaySpeed=parseInt(e(r).find("autoplaySpeed").text(),10);if(e(r).find("include_tooltips").text()=="true")this.include_tooltips=true;if(e(r).find("include_zoom_window").text()=="true")this.include_zoom_window=true;var i=e(r).find("panel");this.panel_options.width=parseInt(e(i).find("width").text(),10);this.panel_options.height=parseInt(e(i).find("height").text(),10);this.panel_options.xOffset=parseInt(e(i).find("xOffset").text(),10);this.panel_options.yOffset=parseInt(e(i).find("yOffset").text(),10);this.panel_options.background_color=e(i).find("background_color").text();this.panel_options.background_alpha=e(i).find("background_alpha").text();this.panel_options.background_pattern=e(i).find("background_pattern").text();this.panel_options.round_corners=e(i).find("round_corners").text()+"px";this.panel_options.show=e(i).find("show").text();this.panel_options.buttons_side_margin=parseInt(e(i).find("buttons_side_margin").text(),10);this.panel_options.buttons_tween_time=parseInt(e(i).find("buttons_tween_time").text(),10);this.panel_options.ui_folder=e(i).find("ui_folder").text();this.panel_options.buttons_width=parseInt(e(i).find("buttons_width").text(),10);this.panel_options.buttons_height=parseInt(e(i).find("buttons_height").text(),10);this.panel_options.divider_width=parseInt(e(i).find("divider_width").text(),10);this.panel_options.divider_height=parseInt(e(i).find("divider_height").text(),10);this.panel_options.slider_width=e(i).find("slider_width").text();this.panel_options.slider_height=parseInt(e(i).find("slider_height").text(),10);this.panel_options.slider_background_color=e(i).find("slider_background_color").text();this.panel_options.slider_background_alpha=e(i).find("slider_background_alpha").text();this.panel_options.slider_background_pattern=e(i).find("slider_background_pattern").text();this.panel_options.slider_round_corners=e(i).find("slider_round_corners").text()+"px";this.panel_options.zoom_subbuttons_width=parseInt(e(i).find("zoom_subbuttons_width").text(),10);this.panel_options.zoom_subbuttons_height=parseInt(e(i).find("zoom_subbuttons_height").text(),10);this.panel_options.zoom_subbuttons_distance=parseInt(e(i).find("zoom_subbuttons_distance").text(),10);this.panel_options.dragger_width=parseInt(e(i).find("dragger_width").text(),10);this.panel_options.dragger_height=parseInt(e(i).find("dragger_height").text(),10);var s=e(r).find("loading");this.loading_text=e(s).find("loading_text").text();this.loading_options.background_color=e(s).find("background_color").text();this.loading_options.background_alpha=e(s).find("background_alpha").text();this.loading_options.background_pattern=e(s).find("background_pattern").text();this.loading_options.text_font=e(s).find("text_font").text();this.loading_options.text_size=e(s).find("text_size").text();this.loading_options.text_color=e(s).find("text_color").text();this.loading_options.text_span_color=e(s).find("text_span_color").text();this.loading_options.text_background_color=e(s).find("text_background_color").text();this.loading_options.text_background_alpha=e(s).find("text_background_alpha").text();this.loading_options.text_background_pattern=e(s).find("text_background_pattern").text();this.loading_options.text_background_round_corner=e(s).find("text_background_round_corner").text()+"px";var o=e(r).find("controls");e(o).find("control").each(function(t){var r=e(this);if(r.text()=="hyperlink")n.controlsExtras.push(r.attr("href"));else n.controlsExtras.push("none");n.controls.push(r.text())});var u=e(r).find("tooltips_texts");this.tooltips_texts.rotate=e(u).find("rotate").text();this.tooltips_texts.pan=e(u).find("pan").text();this.tooltips_texts.rotate_slider=e(u).find("rotate_slider").text();this.tooltips_texts.rotate_left=e(u).find("rotate_left").text();this.tooltips_texts.rotate_right=e(u).find("rotate_right").text();this.tooltips_texts.reset=e(u).find("reset").text();this.tooltips_texts.zoom_slider=e(u).find("zoom_slider").text();this.tooltips_texts.zoom_in=e(u).find("zoom_in").text();this.tooltips_texts.zoom_out=e(u).find("zoom_out").text();this.tooltips_texts.hyperlink=e(u).find("hyperlink").text();this.tooltips_texts.play=e(u).find("play").text();this.tooltips_texts.pause=e(u).find("pause").text();var a=e(r).find("tooltips");this.tooltips_options.text_font=e(a).find("text_font").text();this.tooltips_options.text_size=e(a).find("text_size").text();this.tooltips_options.text_color=e(a).find("text_color").text();this.tooltips_options.left_right_padding=e(a).find("left_right_padding").text();this.tooltips_options.top_bottom_padding=e(a).find("top_bottom_padding").text();this.tooltips_options.background_color=e(a).find("background_color").text();this.tooltips_options.background_alpha=e(a).find("background_alpha").text();this.tooltips_options.round_corners=e(a).find("round_corners").text()+"px";this.tooltips_options.fadeTime=parseInt(e(a).find("fadeTime").text(),10);var f=e(r).find("zoom_window");this.zoom_window_options.window_width=e(f).find("window_width").text();this.zoom_window_options.window_height=e(f).find("window_height").text();this.zoom_window_options.background_color=e(f).find("background_color").text();this.zoom_window_options.background_alpha=e(f).find("background_alpha").text();this.zoom_window_options.background_pattern=e(f).find("background_pattern").text();this.zoom_window_options.padding=e(f).find("padding").text();this.zoom_window_options.selection_line_color=e(f).find("selection_line_color").text();this.zoom_window_options.selection_line_alpha=e(f).find("selection_line_alpha").text();if(this.parameters.imagesPath!=undefined)this.imagesPath=this.parameters.imagesPath;if(this.parameters.imagesBigPath!=undefined)this.imagesBigPath=this.parameters.imagesBigPath;if(this.imagesBigPath=="none")this.focusable=false;this.imagesArraySrc=this.parameters.imgArray;this.imagesArraySrcBig=this.parameters.imgArrayBig;this.imagesSrc=this.parameters.imgArrayName;if(this.imagesArraySrc.length==1)this.singleImage=true;this.makeView()},makeView:function(){var t=this.panel_options.height+this.panel_options.yOffset;if(t<0)t=0;this.$main.css({position:"relative",width:this.width+"px",height:this.height+t+"px",margin:"0",padding:"0",top:"0",left:"0","text-align":"center"});this.$bigContent.css({position:"absolute"});this.$imagesHolder.css({position:"absolute"});if(this.include_zoom_window){this.$zoomWindow=e("<div></div>");this.$zoomWindowBox=e("<div></div>");this.$zoomClickable=e("<div></div>");var r=e("<div></div>");this.$zoomWindow.css({position:"absolute",top:"5px",left:"5px",padding:this.zoom_window_options.padding+"px",opacity:"0",display:"none"});this.$zoomClickable.css({width:"100%",height:"100%",position:"absolute"});this.$zoomWindowBox.css({position:"absolute",border:"solid 1px "+this.zoom_window_options.selection_line_color,opacity:this.zoom_window_options.selection_line_alpha});r.css({width:"100%",height:"100%","background-color":"#ffffff",opacity:"0"});this.$zoomWindowBox.append(r);this.$zoomWindow.append(this.$zoomClickable,this.$zoomWindowBox);S(this.$zoomWindow,this.zoom_window_options.background_color,this.zoom_window_options.background_alpha,this.zoom_window_options.background_pattern)}this.$view.css({position:"relative",width:"100%",height:this.height+"px",overflow:"hidden"});this.$panel.css({position:"absolute",width:this.panel_options.width+"px",height:this.panel_options.height+"px",top:this.height+parseInt(this.panel_options.yOffset,10)+"px",left:(this.width-this.panel_options.width)/2+parseInt(this.panel_options.xOffset,10)+"px"});S(this.$panel,this.panel_options.background_color,this.panel_options.background_alpha,this.panel_options.background_pattern);E(this.$panel,this.panel_options.round_corners);this.$loader.css({zoom:"1",position:"absolute",width:"100%",height:"100%","text-align":"center",top:0,left:0});this.$loadingText.css({padding:"8px 20px",position:"relative",top:this.height/2-20+"px",display:"inline-block"});E(this.$loadingText,this.loading_options.text_background_round_corner);S(this.$loader,this.loading_options.background_color,this.loading_options.background_alpha,this.loading_options.background_pattern);S(this.$loadingText,this.loading_options.text_background_color,this.loading_options.text_background_alpha,this.loading_options.text_background_pattern);w(this.$loadingText,this.loading_options.text_font,this.loading_options.text_color,this.loading_options.text_size);for(var s=0;s<this.controls.length;s++){if(this.controls[s]=="left"||this.controls[s]=="right"||this.controls[s]=="rotate"||this.controls[s]=="pan"||this.controls[s]=="hyperlink"||this.controls[s]=="reset"||this.controls[s]=="zoom-in"||this.controls[s]=="zoom-out"){var o=e('<a href="#"></a>').appendTo(this.$panel);o.css({position:"relative","float":"left",margin:this.panel_options.height/2-this.panel_options.buttons_height/2+"px "+this.panel_options.buttons_side_margin+"px",width:this.panel_options.buttons_width+"px",height:this.panel_options.buttons_height+"px",top:0,left:0});buttonsClass(o,this.panel_options.ui_folder+this.controls[s]+"_out.png",this.panel_options.ui_folder+this.controls[s]+"_over.png",this.panel_options.buttons_width,this.panel_options.buttons_height,this.panel_options.buttons_tween_time);x(o);o.click(function(){return false});if(this.include_tooltips){var u=this.getHint(this.controls[s]);var a=this.makeTooltip(u,o,s)}if(this.controls[s]=="left")o.bind(i,e.proxy(this.leftControlDown,this));else if(this.controls[s]=="right")o.bind(i,e.proxy(this.rightControlDown,this));else if(this.controls[s]=="rotate"){this.$rotateButton=o;o.bind(f,e.proxy(this.changeToRotate,this))}else if(this.controls[s]=="pan"){this.$panButton=o;o.bind(f,e.proxy(this.changeToPan,this))}else if(this.controls[s]=="reset")o.bind(f,e.proxy(this.resetControlClick,this));else if(this.controls[s]=="zoom-out")o.bind(f,e.proxy(this.zoomoutControlClick,this));else if(this.controls[s]=="zoom-in")o.bind(f,e.proxy(this.zoominControlClick,this));else if(this.controls[s]=="hyperlink"){o.attr("href",this.controlsExtras[s]);o.attr("target","_blank");o.unbind("click");o.click(function(){return true})}}else if(this.controls[s]=="zoom-slider"){var l=e("<div></div>");var c=Math.max(this.panel_options.slider_height,this.panel_options.dragger_height);l.css({position:"relative","float":"left",height:c,margin:this.panel_options.height/2-c/2+"px "+this.panel_options.zoom_subbuttons_distance+"px",top:0,left:0});var h=e('<a href="#"></a>');buttonsClass(h,this.panel_options.ui_folder+"minus_out.png",this.panel_options.ui_folder+"minus_over.png",this.panel_options.zoom_subbuttons_width,this.panel_options.zoom_subbuttons_height,this.panel_options.buttons_tween_time);var p=e('<a href="#"></a>');buttonsClass(p,this.panel_options.ui_folder+"plus_out.png",this.panel_options.ui_folder+"plus_over.png",this.panel_options.zoom_subbuttons_width,this.panel_options.zoom_subbuttons_height,this.panel_options.buttons_tween_time);var d=e('<a href="#"></a>');buttonsClass(d,this.panel_options.ui_folder+"slider_out.png",this.panel_options.ui_folder+"slider_over.png",this.panel_options.dragger_width,this.panel_options.dragger_height,this.panel_options.buttons_tween_time);var v=e('<a href="#"></a>');if(this.panel_options.slider_width=="auto")this.sliderWidth=this.panel_options.width-((this.controls.length-1)*(this.panel_options.buttons_width+this.panel_options.buttons_side_margin*2)+this.panel_options.zoom_subbuttons_width*2+this.panel_options.buttons_side_margin*2+this.panel_options.zoom_subbuttons_distance*2+this.panel_options.divider_width*(this.controls.length-1)+1);else this.sliderWidth=parseInt(this.panel_options.slider_width,10);v.css({position:"absolute",width:this.sliderWidth,height:this.panel_options.slider_height,top:c/2-this.panel_options.slider_height/2,left:"0"});E(v,this.panel_options.slider_round_corners);S(v,this.panel_options.slider_background_color,this.panel_options.slider_background_alpha,this.panel_options.slider_background_pattern);h.css({position:"relative","float":"left",width:this.panel_options.zoom_subbuttons_width,height:this.panel_options.zoom_subbuttons_height,margin:this.panel_options.height/2-this.panel_options.zoom_subbuttons_height/2+"px 0px","margin-left":this.panel_options.buttons_side_margin});p.css({position:"relative","float":"left",width:this.panel_options.zoom_subbuttons_width,height:this.panel_options.zoom_subbuttons_height,margin:this.panel_options.height/2-this.panel_options.zoom_subbuttons_height/2+"px 0px","margin-right":this.panel_options.buttons_side_margin});d.css({position:"absolute",left:-this.panel_options.dragger_width/2+"px",width:this.panel_options.dragger_width});l.css({width:this.sliderWidth});l.append(v,d);this.$panel.append(h,l,p);this.$zoomSlider=d;this.$zoomMinus=h;this.$zoomPlus=p;d.click(function(){return false});x(p);x(h);x(d);this.sliderFrom=-this.panel_options.dragger_width/2;this.sliderTo=this.sliderWidth-this.panel_options.dragger_width/2;p.click(e.proxy(this.zoomPlusControlClick,this));p.bind(i,e.proxy(this.zoomPlusControlDown,this));h.click(e.proxy(this.zoomMinusControlClick,this));h.bind(i,e.proxy(this.zoomMinusControlDown,this));d.bind(i,e.proxy(this.zoomSliderDown,this));v.click(e.proxy(this.zoomBackClick,this));if(this.include_tooltips){var u="Zoom 0%";var a=this.makeTooltip(u,d,"zoom-slider",[h,p])}}else if(this.controls[s]=="playback-slider"){var m=e("<div></div>");var g=Math.max(this.panel_options.slider_height,this.panel_options.dragger_height);m.css({position:"relative","float":"left",height:g,margin:this.panel_options.height/2-g/2+"px "+this.panel_options.buttons_side_margin+"px",top:0,left:0});var d=e('<a href="#"></a>');buttonsClass(d,this.panel_options.ui_folder+"slider_out.png",this.panel_options.ui_folder+"slider_over.png",this.panel_options.dragger_width,this.panel_options.dragger_height,this.panel_options.buttons_tween_time);var v=e('<a href="#"></a>');if(this.panel_options.slider_width=="auto")this.playbackSliderWidth=this.panel_options.width-((this.controls.length-1)*(this.panel_options.buttons_width+this.panel_options.buttons_side_margin*2)+this.panel_options.buttons_side_margin*2+this.panel_options.divider_width*(this.controls.length-1)+1);else this.playbackSliderWidth=parseInt(this.panel_options.slider_width,10);var y=e("<div></div>");v.css({position:"absolute",width:this.playbackSliderWidth,height:this.panel_options.slider_height,top:g/2-this.panel_options.slider_height/2,left:"0"});E(v,this.panel_options.slider_round_corners);S(v,this.panel_options.slider_background_color,this.panel_options.slider_background_alpha,this.panel_options.slider_background_pattern);d.css({position:"absolute",left:-this.panel_options.dragger_width/2+"px"});m.css({width:this.playbackSliderWidth});m.append(v,d);this.$panel.append(m);this.$playbackSlider=d;d.click(function(){return false});x(d);this.sliderFrom=-this.panel_options.dragger_width/2;this.sliderTo=this.playbackSliderWidth-this.panel_options.dragger_width/2;d.bind(i,e.proxy(this.playbackSliderDown,this));v.bind(f,e.proxy(this.playbackBackClick,this));if(this.include_tooltips){var u="Rotate 0";var a=this.makeTooltip(u,this.$playbackSlider,"playback-slider")}}else if(this.controls[s]=="autoplay"){var o=e("<div></div>");o.css({position:"relative","float":"left",margin:this.panel_options.height/2-this.panel_options.buttons_height/2+"px "+this.panel_options.buttons_side_margin+"px",width:this.panel_options.buttons_width+"px",height:this.panel_options.buttons_height+"px",overflow:"hidden",top:0,left:0});var b=e('<a href="#"></a>');buttonsClass(b,this.panel_options.ui_folder+"play_out.png",this.panel_options.ui_folder+"play_over.png",this.panel_options.buttons_width,this.panel_options.buttons_height,this.panel_options.buttons_tween_time);var T=e('<a href="#"></a>');buttonsClass(T,this.panel_options.ui_folder+"pause_out.png",this.panel_options.ui_folder+"pause_over.png",this.panel_options.buttons_width,this.panel_options.buttons_height,this.panel_options.buttons_tween_time);b.css({position:"absolute",top:"0",left:"0"});T.css({position:"absolute",top:"0",left:"0"});o.append(b,T);this.$panel.append(o);this.$autoplayPlay=b;this.$autoplayPause=T;if(this.autoplay)b.stop().fadeTo(0,0).css("display","none");else T.stop().fadeTo(0,0).css("display","none");o.click(e.proxy(this.autoplayClick,this));if(this.include_tooltips){var u=this.tooltips_texts.play;if(this.autoplay)u=this.tooltips_texts.pause;var a=this.makeTooltip(u,o,"autoplay")}}if(s!=this.controls.length-1){var N=e("<div></div>");N.css({position:"relative","float":"left",margin:this.panel_options.height/2-this.panel_options.divider_height/2+"px 0px",width:this.panel_options.divider_width,height:this.panel_options.divider_height});N.append('<img src="'+this.panel_options.ui_folder+'divider.png" />');this.$panel.append(N)}}if(this.mouse_wheel_function!="none")this.$view.mousewheel(e.proxy(this.mouseWheelControl,this));this.$loader.append(this.$loadingText);this.$view.append(this.$imagesHolder,this.$zoomWindow,this.$bigContent);this.$main.append(this.$view);this.$main.append(this.$panel);this.$main.append(this.$loader);this.$root.append(this.$main);e("*",this.$main).bind(i,e.proxy(this.clearSmall,this));e("*",this.$view).unbind(i);if(this.panel_options.show=="roll_over"&&!n){this.$panel.css("opacity","0");var C=this;this.$main.hover(function(){if(!C.$panel.hasClass("blocked"))C.$panel.stop().fadeTo(500,1)},function(){C.$panel.stop().fadeTo(500,0)})}this.loadImage(0)},changeToRotate:function(){this.mode="rotate"},changeToPan:function(){this.mode="pan"},leftRightControlUp:function(){if(this.autoplay)this.speedDegDefault=this.autoplaySpeed;else this.speedDegDefault=0;e(document).unbind(o);return false},leftControlDown:function(){this.speedDegDefault=7;e(document).bind(o,e.proxy(this.leftRightControlUp,this));return false},rightControlDown:function(){this.speedDegDefault=-7;e(document).bind(o,e.proxy(this.leftRightControlUp,this));return false},resetControlClick:function(){this.zoom=this.minZoom;this.goToDegree=true;this.goToDegreeNum=0},zoomoutControlClick:function(){this.zoom=this.minZoom;return false},zoominControlClick:function(){this.zoom=this.maxZoom;return false},zoomPlusControlClick:function(){this.incrementZoom();return false},zoomMinusControlClick:function(){this.decrementZoom();return false},incrementZoom:function(){this.zoom+=this.zoomSpeed},decrementZoom:function(){this.zoom-=this.zoomSpeed},zoomControlUp:function(){clearInterval(this.zoomBtnInterval);this.changeFocus();e(document).unbind(o);return false},zoomPlusControlDown:function(){this.zoomBtnInterval=setInterval(e.proxy(this.incrementZoom,this),100);e(document).bind(o,e.proxy(this.zoomControlUp,this));return false},zoomMinusControlDown:function(){this.zoomBtnInterval=setInterval(e.proxy(this.decrementZoom,this),100);e(document).bind(o,e.proxy(this.zoomControlUp,this));return false},zoomSliderMove:function(e){var t=e.pageX-this.posIniX;var n=this.sliderX+t;if(n<this.sliderFrom)n=this.sliderFrom;if(n>this.sliderTo)n=this.sliderTo;this.$zoomSlider.css({left:n+"px"});var r=(n+this.panel_options.dragger_width/2)/this.sliderWidth;this.zoom=r*(this.maxZoom+(1-this.minZoom)-1)+1;this.zoomCurrent=this.zoom},zoomSliderUp:function(){this.draggingZoomSlider=false;b();return false},zoomSliderDown:function(t){this.posIniX=t.pageX;this.sliderX=parseInt(this.$zoomSlider.css("left"),10);this.draggingZoomSlider=true;e(document).bind(s,e.proxy(this.zoomSliderMove,this));e(document).bind(o,e.proxy(this.zoomSliderUp,this));return false},zoomBackClick:function(t){var n=e(t.target).offset();var r=t.pageX-n.left-this.panel_options.dragger_width/2-3;if(r<this.sliderFrom)r=this.sliderFrom;if(r>this.sliderTo)r=this.sliderTo;var i=(r+this.panel_options.dragger_width/2)/this.sliderWidth;this.zoom=i*(this.maxZoom-this.minZoom)+1;return false},playbackSliderMove:function(e){var t=e.pageX-this.posIniX;var n=this.sliderX+t;if(n<this.sliderFrom)n=this.sliderFrom;if(n>this.sliderTo)n=this.sliderTo;this.$playbackSlider.css({left:n+"px"});var r=(n+this.panel_options.dragger_width/2)/this.playbackSliderWidth;this.goToDegree=true;this.goToDegreeNum=Math.round(r*360)},playbackSliderUp:function(e){this.draggingPlaybackSlider=false;b();return false},playbackSliderDown:function(t){this.posIniX=t.pageX;this.sliderX=parseInt(this.$playbackSlider.css("left"),10);this.draggingPlaybackSlider=true;this.goToDegreeNum=this.degrees;e(document).bind(s,e.proxy(this.playbackSliderMove,this));e(document).bind(o,e.proxy(this.playbackSliderUp,this));return false},playbackBackClick:function(t){var n=e(t.target).offset();var r=t.pageX-n.left-this.panel_options.dragger_width/2-3;if(r<this.sliderFrom)r=this.sliderFrom;if(r>this.sliderTo)r=this.sliderTo;var i=(r+this.panel_options.dragger_width/2)/this.playbackSliderWidth;this.goToDegree=true;this.goToDegreeNum=Math.round(i*360);return false},autoplayClick:function(){var e=this;if(this.autoplay){y("autoplay",this.tooltips_texts.play);this.autoplay=false;this.speedDegDefault=0;this.$autoplayPlay.stop().css("display","block").fadeTo(this.panel_options.buttons_tween_time,1);this.$autoplayPause.stop().fadeTo(this.panel_options.buttons_tween_time,0,function(){e.$autoplayPause.css("display","none")})}else{y("autoplay",this.tooltips_texts.pause);this.autoplay=true;this.speedDegDefault=this.autoplaySpeed;this.$autoplayPause.stop().css("display","block").fadeTo(this.panel_options.buttons_tween_time,1);this.$autoplayPlay.stop().fadeTo(this.panel_options.buttons_tween_time,0,function(){e.$autoplayPlay.css("display","none")})}g(this.$autoplayPlay,"autoplay");return false},mouseWheelControl:function(e,t){this.clearSmall();if(this.mouse_wheel_function=="zoom")this.zoom+=t*this.mouse_wheel_speed;else if(this.mouse_wheel_function=="rotate")this.speedDeg+=t*this.mouse_wheel_speed;return false},loadImage:function(t){var n=new Image;var r=this;n.onload=function(){if(t==0){var s=n.width;var o=n.height;if(!(s==r.width&&o==r.height)){var u=s/r.width;if(u>o/r.height)u=o/r.height;r.iniWidth=s/u;r.iniHeight=o/u;r.zoom=1-(u-1);r.zoomCurrent=r.zoom}else{r.iniWidth=s;r.iniHeight=o;r.zoom=1;r.zoomCurrent=r.zoom}r.minZoom=r.zoom;r.$imagesHolder.css({width:r.iniWidth+"px",height:r.iniHeight+"px"});if(r.include_zoom_window){var u=1;if(r.zoom_window_options.window_width=="auto")u=o/r.zoom_window_options.window_height;else if(r.zoom_window_options.window_height=="auto")u=s/r.zoom_window_options.window_width;else{alert("Error on a zoom window parameter on the xml -> width OR height must be 'auto'");return}var a=Math.round(s/u);var f=Math.round(o/u);r.$zoomWindow.css({width:a+"px",height:f+"px"});r.zoom_window_width=a;r.zoom_window_height=f}}e(n).css({width:"100%",height:"100%"});var l=e("<div rel='"+t+"'></div>");l.css({position:"absolute",width:"100%",height:"100%"});l.append(n);r.$imagesHolder.append(l);if(r.include_zoom_window){var c=l.clone().css({padding:r.zoom_window_options.padding+"px",width:"auto",height:"auto"}).prependTo(r.$zoomWindow);r.zoom_window_images.push(c)}r.images.push(l);l.bind(i,e.proxy(r.clearSmall,r));if(t==r.imagesSrc.length-1)r.loadFinished();else r.loadImage(++t)};var s=this.loading_text;s=s.replace("loaded_images",t+1);s=s.replace("total_images",this.imagesSrc.length);s=s.replace("#span#","<span style='color:"+this.loading_options.text_span_color+"'>");s=s.replace("#spanEnd#","</span>");this.$loadingText.html(s);n.src=this.imagesArraySrc[t]},loadFinished:function(){this.$loader.fadeOut(500);this.currentImage=0;this.numImages=this.imagesSrc.length;if(this.include_zoom_window){this.relativeExcessW=this.zoom_window_width/this.iniWidth*(this.iniWidth-this.width);this.relativeExcessH=this.zoom_window_height/this.iniHeight*(this.iniHeight-this.height)}this.updateImage();if(this.autoplay)this.speedDegDefault=this.autoplaySpeed;this.dragAndDrop()},onRotateMove:function(e){if(n){if(h!=e.pageX&&c>2)this.currentX=e.pageX;else if(c<=2){h=e.pageX;c++}}else this.currentX=e.pageX},onRotateUp:function(){this.grabHandOpen(this.$imagesHolder,this);this.dragging=false;this.changeFocus();b()},onPanMove:function(e){var t;var r;if(n){if(h!=e.pageX&&p!=e.pageY&&c>2){t=e.pageX;r=e.pageY}else if(c<=2){h=e.pageX;p=e.pageY;t=this.panPrevX;r=this.panPrevY;c++}}else{t=e.pageX;r=e.pageY}var i=this.panPrevLeft+(this.panPrevX-t);var s=this.panPrevTop+(this.panPrevY-r);var o=(this.currentWidth-this.width)/2;var u=(this.currentHeight-this.height)/2;if(i<-o)i=-o;if(i>o)i=o;if(s<-u)s=-u;if(s>u)s=u;this.viewLeft=i;this.viewTop=s},onPanUp:function(){this.grabHandOpen(this.$imagesHolder,this);this.panning=false;b();return false},startDrag:function(t){this.grabHandClose(this.$imagesHolder,this);c=0;if(this.mode=="rotate"&&!this.singleImage){this.removeFocus();this.positionClickedX=t.pageX;this.oldDif=0;this.degWhenClicked=this.degrees;this.currentX=this.positionClickedX;this.dragging=true;e(document).bind(s,e.proxy(this.onRotateMove,this));e(document).bind(o,e.proxy(this.onRotateUp,this));return false}else{this.panPrevX=t.pageX;this.panPrevY=t.pageY;this.panning=true;this.panPrevLeft=this.viewLeft;this.panPrevTop=this.viewTop;this.zoomWhenPad=this.zoom;e(document).bind(s,e.proxy(this.onPanMove,this));e(document).bind(o,e.proxy(this.onPanUp,this));return false}},dragAndDrop:function(){var t=this;x(this.$imagesHolder);this.$imagesHolder.hover(function(){t.grabHandOpen(t.$imagesHolder,t)},function(){t.$imagesHolder.css("cursor","auto")});this.$imagesHolder.bind(i,e.proxy(this.startDrag,this));if(this.include_zoom_window){x(this.$zoomWindowBox);this.$zoomWindowBox.hover(function(){t.grabHandOpen(t.$zoomWindowBox,t)},function(){t.$zoomWindowBox.css("cursor","auto")});this.$zoomClickable.click(function(e){var n=e.pageX;var r=e.pageY;var i=t.$zoomWindow.offset();var s=(t.currentWidth-t.width)/2;var o=(t.currentHeight-t.height)/2;var u=parseInt(t.$zoomWindowBox.css("width"),10);var a=parseInt(t.$zoomWindowBox.css("height"),10);var f=-s+(n-i.left-u/2)*(t.width/u);var l=-o+(r-i.top-a/2)*(t.height/a);if(f<-s)f=-s;if(f>s)f=s;if(l<-o)l=-o;if(l>o)l=o;t.viewLeft=f;t.viewTop=l});t.$zoomWindowBox.bind(i,function(n){t.grabHandClose(t.$zoomWindowBox,t);var r=n.pageX;var i=n.pageY;t.panning=true;var u=t.viewLeft;var a=t.viewTop;t.zoomWhenPad=t.zoom;e(document).bind(s,function(e){var n=e.pageX;var s=e.pageY;var o=u-(r-n)*(t.width/parseInt(t.$zoomWindowBox.css("width"),10));var f=a-(i-s)*(t.height/parseInt(t.$zoomWindowBox.css("height"),10));var l=(t.currentWidth-t.width)/2;var c=(t.currentHeight-t.height)/2;if(o<-l)o=-l;if(o>l)o=l;if(f<-c)f=-c;if(f>c)f=c;t.viewLeft=o;t.viewTop=f;return false});e(document).bind(o,function(e){t.grabHandOpen(t.$imagesHolder,t);t.panning=false;b();return false});return false})}},makeTooltip:function(n,i,s,o){function h(){if(!e(this).hasClass("disabled")){var t=g(i,s);t.stop().fadeTo(c.tooltips_options.fadeTime,1);if(r)l.stop().fadeTo(c.tooltips_options.fadeTime,c.tooltips_options.background_alpha)}}function p(){if(!e(this).hasClass("removing")){var t=e(".tooltip[rel='"+s+"']");t.stop().fadeTo(c.tooltips_options.fadeTime,0);if(r)l.stop().fadeTo(c.tooltips_options.fadeTime,0)}}var f=e('<div class="tooltip"><span>'+n+"</span></div>");var l=e("<div></div>");f.css({"-moz-font-feature-settings":"normal","-moz-font-language-override":"normal",display:"inline-block","pointer-events":"none",position:"absolute","text-align":"center","text-decoration":"none",padding:this.tooltips_options.top_bottom_padding+"px "+this.tooltips_options.left_right_padding+"px","background-color":this.tooltips_options.background_color,opacity:"0"});l.css({"float":"left",position:"absolute",top:"100%",left:"50%","margin-left":"-5px",width:"0px",height:"0px","border-left":"5px solid transparent","border-right":"5px solid transparent","border-top":"5px solid "+this.tooltips_options.background_color,opacity:this.tooltips_options.background_alpha});w(f,this.tooltips_options.text_font,this.tooltips_options.text_color,this.tooltips_options.text_size);E(f,this.tooltips_options.round_corners);S(f,this.tooltips_options.background_color,this.tooltips_options.background_alpha,"none");f.append(l);t.append(f);f.attr("rel",s);g(i,s);var c=this;if(r){f.stop().fadeTo(0,0);l.stop().fadeTo(0,0)}i.bind(u,h);i.bind(a,p);if(o!=null)e(o).each(function(){e(this).bind(u,h);e(this).bind(a,p)});return f},getHint:function(e){var t;switch(e){case"left":t=this.tooltips_texts.rotate_left;break;case"right":t=this.tooltips_texts.rotate_right;break;case"rotate":t=this.tooltips_texts.rotate;break;case"pan":t=this.tooltips_texts.pan;break;case"hyperlink":t=this.tooltips_texts.hyperlink;break;case"reset":t=this.tooltips_texts.reset;break;case"zoom-in":t=this.tooltips_texts.zoom_in;break;case"zoom-out":t=this.tooltips_texts.zoom_out;break;case"zoom_slider":var n=Math.round((this.zoom-this.minZoom)/(this.maxZoom-this.minZoom)*100)+"";t=this.tooltips_texts.zoom_slider;t=t.replace("zoom_number",n);break;case"rotate_slider":var r;var i=this.degrees;if(this.degrees<0)i=360+this.degrees;if(this.draggingPlaybackSlider)r=Math.round(this.goToDegreeNum)+"";else r=Math.round(i)+"";t=this.tooltips_texts.rotate_slider;t=t.replace("rotate_number",r);break}return t},clearSmall:function(){if(this.$hotspotsSmall!=null){this.$hotspotsSmall.stop().fadeTo(this.smallTweenTime,0,function(){e(this).remove()});this.$hotspotsSmall=null}},updateSmall:function(){if(this.$hotspotsSmall!=null){this.$hotspotsSmall.css({left:parseInt(this.$smallHotspot.css("left"),10)-this.smallWidth/2,top:parseInt(this.$smallHotspot.css("top"),10)-this.smallHeight/2})}},getHotspotButton:function(t,r){var s=this;var u=-1;for(var a=0;a<this.hotspotsButtons.length;a++)if(this.hotspotsButtons[a].id==t.id){u=a;break}if(u==-1)return null;var l=parseInt(this.hotspotsButtons[u].width,10);var c=parseInt(this.hotspotsButtons[u].height,10);var h=e("<a href='#' rel="+r+"></a>").css({position:"absolute","margin-left":Math.round(-l/2)+"px","margin-top":Math.round(-c/2)+"px"});buttonsClass(h,this.hotspotsImagesPath+this.hotspotsButtons[u].out,this.hotspotsImagesPath+this.hotspotsButtons[u].over,l,c,parseInt(this.hotspotsButtons[u].tweenTime,10));if(t.tooltip!="none"&&t.tooltip!=null){var p=t.tooltip;var d=this.makeTooltip(p,h,"cont"+r);this.currentHotspotsTooltips.push(d)}if(t.type=="link"){h.attr({href:t.content,target:"_blank"});if(n)h.bind(f,function(){window.location=t.content;return false})}if(t.type=="small")h.bind(f,function(){s.clearSmall();var n=t.content;var r=e(this);var u=e("<div></div>").css({width:n.width,position:"absolute",padding:n.padding+"px",opacity:"0"}).html(n.html);E(u,n.round_corners);S(u,n.background_color,n.background_alpha,n.background_pattern);s.smallTweenTime=n.fadeTime;s.$imagesHolder.append(u.fadeTo(s.smallTweenTime,1));s.$hotspotsSmall=u;s.$smallHotspot=r;s.smallWidth=n.width;s.smallHeight=u.outerHeight();e("a",u).live(i,function(){return true});e("a",u).live(o,function(){return true});e("a",u).live(f,function(){return true});return false});else if(t.type=="big")h.bind(f,function(){var i=t.content;var o=e(this);var u;var a=e("<div></div>");s.$bigContent.append(a);a.load(i.html);e.proxy(s.initScroll(a,s.width,s.height),s);a.css({width:"100%",position:"absolute",left:"0",top:"0"});s.$bigContent.css({width:"100%",height:"100%",opacity:"0"});S(s.$bigContent,i.background_color,i.background_alpha,i.background_pattern);var f=-1;for(var l=0;l<s.hotspotsButtons.length;l++)if(s.hotspotsButtons[l].id==i.close_button_id){f=l;break}if(f==-1)return null;var c=parseInt(s.hotspotsButtons[f].width,10);var h=parseInt(s.hotspotsButtons[f].height,10);var p=e("<a href='#' rel="+r+"></a>").css({position:"absolute",left:s.width-c+i.closeOffsetX+"px",top:i.closeOffsetY+"px"});buttonsClass(p,s.hotspotsImagesPath+s.hotspotsButtons[f].out,s.hotspotsImagesPath+s.hotspotsButtons[f].over,c,h,parseInt(s.hotspotsButtons[f].tweenTime,10));s.$bigContent.append(p).stop().fadeTo(i.fadeTime,1);p.click(function(){if(s.panel_options.show=="roll_over")s.$panel.removeClass("blocked").stop().fadeTo(500,1);s.$bigContent.stop().fadeTo(i.fadeTime,0,function(){e(this).empty().css({width:"0",height:"0"})});return false});if(s.panel_options.show=="roll_over")s.$panel.addClass("blocked").stop().fadeTo(500,0);return false});return h},clearHotspots:function(){for(var t=0;t<this.currentHotspots.length;t++){this.currentHotspots[t].addClass("disabled removing").stop().fadeTo(500,0,function(){e(this).remove()})}for(var t=0;t<this.currentHotspotsTooltips.length;t++){this.currentHotspotsTooltips[t].stop().fadeTo(500,0,function(){e(this).remove()})}this.currentHotspots=Array();this.currentHotspotsTooltips=Array()},updateHotspots:function(){for(var e=0;e<this.currentHotspots.length;e++){if(this.hotspots[this.currentImage]!=null){var t=this.hotspots[this.currentImage][e];this.currentHotspots[e].css({left:Math.round(t.x*this.zoomCurrent)+"px",top:Math.round(t.y*this.zoomCurrent)+"px"});g(this.currentHotspots[e],"cont"+this.currentHotspots[e].attr("rel"))}}this.updateSmall()},bringHotspotsTimeout:function(){if(this.hotspots[this.currentImage]!=null){for(var e=0;e<this.hotspots[this.currentImage].length;e++){var t=this.hotspots[this.currentImage][e];var n=this.getHotspotButton(t,e).css({left:t.x+"px",top:t.y+"px",opacity:"0"}).fadeTo(500,1);if(n!=null){this.$imagesHolder.append(n);this.currentHotspots.push(n)}}}},bringHotspots:function(){clearTimeout(this.hotspotsTimer);if(this.hotspots[this.currentImage]!=null)this.hotspotsTimer=setTimeout(e.proxy(this.bringHotspotsTimeout,this),100)},getToFront:function(){if(this.currentImage>=0&&this.currentImage<this.numImages)if(this.currentImage!=this.oldImage){for(var e=0;e<this.numImages;e++){this.images[e].css("display","none");if(this.include_zoom_window)this.zoom_window_images[e].css("display","none")}this.images[this.currentImage].css("display","block");if(this.include_zoom_window)this.zoom_window_images[this.currentImage].css("display","block");this.oldImage=this.currentImage;this.clearHotspots();this.clearSmall();this.bringHotspots();this.changeFocus()}},removeFocus:function(){clearTimeout(this.focusTimer);this.focusing=false;this.focused=false;this.focusedNum=-1;if(this.$bigImage!=null)this.$bigImage.remove()},changeFocus:function(){if(this.focusable){this.removeFocus();if(this.zoom>1&&!this.dragging){this.focusTimer=setTimeout(e.proxy(this.updateFocus,this),500)}}},updateFocus:function(){if(this.focusable){clearTimeout(this.focusTimer);this.focusing=true;this.loadBigImage()}},loadBigImage:function(){if(!this.dragging&&this.focusable){if(this.focused)this.removeFocus();var t=new Image;var n=this.currentImage;var r=this;t.onload=function(){if(n==r.currentImage&&r.zoom>1){if(r.focused)r.removeFocus();r.focused=true;r.focusing=false;r.focusedNum=n;var i=r.images[n];var s=e(t);s.css({top:"0",left:"0",width:"100%",height:"100%",position:"absolute"});i.append(s);r.$bigImage=s}};t.src=this.imagesArraySrcBig[n]}},calculateDegree:function(){if(!this.dragging&&!this.goToDegree&&!this.draggingPlaybackSlider){var e=(this.speedDegDefault-this.speedDeg)/this.ease;this.speedDeg+=e;this.degrees+=Math.round(this.speedDeg)}else if(this.goToDegree){var e;if(this.draggingPlaybackSlider)e=this.goToDegreeNum-this.degrees;else e=(this.goToDegreeNum-this.degrees)/this.ease;this.degrees+=e;if(Math.round(this.degrees)==this.goToDegreeNum){this.goToDegree=false;this.degrees=Math.round(this.degrees)}}while(this.degrees>360)this.degrees-=360;while(this.degrees<-360)this.degrees+=360;var t=this.degrees;if(this.degrees<0)t=360+this.degrees;this.currentImage=Math.round(t/360*this.numImages);if(this.reverse){if(this.currentImage!=0)this.currentImage=this.numImages-this.currentImage}this.getToFront();if(this.$playbackSlider!=null){g(this.$playbackSlider,"playback-slider");y("playback-slider",this.getHint("rotate_slider"));if(!this.draggingPlaybackSlider){var n=Math.abs(t)/360;var r=n*this.playbackSliderWidth-this.panel_options.dragger_width/2;this.$playbackSlider.css({left:r+"px"})}}},calculateZoom:function(){if(this.zoom<this.minZoom)this.zoom=this.minZoom;if(this.zoom>this.maxZoom)this.zoom=this.maxZoom;var e=(this.zoom-this.zoomCurrent)/this.zoomEase;this.zoomCurrent+=e;this.currentWidth=Math.round(this.iniWidth*this.zoomCurrent);this.currentHeight=Math.round(this.iniHeight*this.zoomCurrent);var t=(this.currentWidth-this.width)/2;var n=(this.currentHeight-this.height)/2;this.posX=Math.round(-t);this.posY=Math.round(-n);this.viewLeft+=this.viewLeft*(this.zoomCurrent-this.zoomWhenPad)/2;this.viewTop+=this.viewTop*(this.zoomCurrent-this.zoomWhenPad)/2;this.zoomWhenPad=this.zoomCurrent;var r=(this.viewLeft-this.viewLeftCurrent)/this.paddingEase;var i=(this.viewTop-this.viewTopCurrent)/this.paddingEase;this.viewLeftCurrent+=r;this.viewTopCurrent+=i;var s=Math.round(this.posX-this.viewLeftCurrent);var o=Math.round(this.posY-this.viewTopCurrent);if(s>0){this.viewLeft=this.posX;s=0}else if(s<-t*2){this.viewLeft=-this.posX;s=-t*2}if(o>0){this.viewTop=this.posY;o=0}else if(o<-n*2){this.viewTop=-this.posY;o=-n*2}if((this.focused||this.focusing)&&this.zoom<=1)this.removeFocus();else if(!this.focusing&&!this.focused&&this.zoom>1)this.updateFocus();this.$imagesHolder.css({width:this.currentWidth+"px",height:this.currentHeight+"px",left:s+"px",top:o+"px"});if(this.include_zoom_window){this.$zoomWindowBox.css({width:Math.round((this.zoom_window_width-this.relativeExcessW)/this.zoomCurrent)+"px",height:Math.round((this.zoom_window_height-this.relativeExcessH)/this.zoomCurrent)+"px",top:Math.round(-o*(this.zoom_window_height/this.currentHeight))+"px",left:Math.round(-s*(this.zoom_window_width/this.currentWidth))+"px"})}if(this.$zoomSlider!=null){g(this.$zoomSlider,"zoom-slider");y("zoom-slider",this.getHint("zoom_slider"));if(!this.draggingZoomSlider){var u=(this.zoomCurrent-this.minZoom)/(this.maxZoom-this.minZoom);var a=u*this.sliderWidth-this.panel_options.dragger_width/2;this.$zoomSlider.css({left:a+"px"});if(this.zoom==this.minZoom)v(this.$zoomMinus,this.buttonsDisabledAlpha);else m(this.$zoomMinus,this.buttonsDisabledAlpha);if(this.zoom==this.maxZoom)v(this.$zoomPlus,this.buttonsDisabledAlpha);else m(this.$zoomPlus,this.buttonsDisabledAlpha)}}},updateImage:function(){if(!this.singleImage)this.calculateDegree();else if(!this.showedHotspots){this.bringHotspots();this.showedHotspots=true}if(this.minZoom!=this.maxZoom){if(Math.round(this.zoom*1e3)!=Math.round(this.zoomCurrent*100))this.calculateZoom()}this.updateHotspots();if(this.dragging){var t=this.positionClickedX-this.currentX;if(n){if(t<20&&t>-20)t=0;t/=2}var r=t-this.oldDif;this.speedDeg=Math.round(r*this.inertia);this.oldDif=t;this.degrees=this.degWhenClicked+t}var i=false;var s=Math.round(this.iniWidth*this.zoom);var o=Math.round(this.iniHeight*this.zoom);if(s>this.width||o>this.height)i=true;if(this.include_zoom_window){if(i&&!this.zoomWindowEnabled){this.$zoomWindow.css("display","block").stop().fadeTo(500,1);this.zoomWindowEnabled=true}else if(!i&&this.zoomWindowEnabled){this.$zoomWindow.stop().fadeTo(500,0,function(){e(this).css("display","none")});this.zoomWindowEnabled=false}}if(!i&&this.mode=="pan")this.mode="rotate";if(this.$panButton!=null){if(this.mode=="pan"||!i)v(this.$panButton,this.buttonsDisabledAlpha);else m(this.$panButton,this.buttonsDisabledAlpha)}if(this.$rotateButton!=null){if(this.mode=="rotate")v(this.$rotateButton,this.buttonsDisabledAlpha);else m(this.$rotateButton,this.buttonsDisabledAlpha)}setTimeout(e.proxy(this.updateImage,this),l)},grabHandOpen:function(e,t){if(t.grab_hand_cursor)e.css("cursor","url("+t.panel_options.ui_folder+"grabhand_open.png) 12 12,auto");else e.css("cursor","pointer")},grabHandClose:function(e,t){if(t.grab_hand_cursor)e.css("cursor","url("+t.panel_options.ui_folder+"grabhand_closed.png) 12 12,auto");else e.css("cursor","pointer")},initScroll:function(t,n,r){var u=t;var a=this;x(t);var f=n;var l=r;t.hover(function(){a.grabHandOpen(t,a)},function(){t.css("cursor","auto")});t.bind(i,function(n){function v(){a.grabHandOpen(u,a);b();e(document).unbind("mouseout");return false}a.grabHandClose(u,a);var r=n.pageX;var i=n.pageY;var c=parseInt(u.css("left"),10);var h=parseInt(u.css("top"),10);var p=u.width();var d=u.height();e(document).bind(s,function(t){var n=t.pageX;var s=t.pageY;var o=c-(r-n);var a=h-(i-s);if(o>0)o=0;else if(o<f-p)o=f-p;if(a>0)a=0;else if(a<l-d)a=l-d;u.css({left:o,top:a});return false});e(document).bind(o,v);e(document).bind("mouseout",v);return false})}};Expo360=function(e){var t=new d(e);t.loadXml();this.goTo=function(e){t.goToDegree=true;t.goToDegreeNum=e};this.zoomTo=function(e){t.zoom=e}}})