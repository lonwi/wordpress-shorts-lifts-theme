function fnFixPng(a){navigator.appVersion;if("Win32"==navigator.platform&&"Microsoft Internet Explorer"==navigator.appName&&window.attachEvent&&parseInt($.browser.version,10)<10){var c=a.css("background-image"),d=c.substring(5,c.length-2);a.css("filter","progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+d+"', sizingMethod='scale')"),a.css("background-image","url(x.gif)")}}function buttonsClass(a,b,c,d,e,f){var g=jQuery(a),h=jQuery('<span class="hover"></span>');g.append(h),g.css("background-image","url("+b+")"),h.css("background-image","url("+c+")"),g.css({"background-image":"url("+b+")","background-repeat":"no-repeat","background-position":"center",width:d+"px",overflow:"hidden",height:e+"px"}),h.css({"background-image":"url("+c+")","background-repeat":"no-repeat","background-position":"center",width:d+"px",height:e+"px",position:"absolute",overflow:"hidden",top:0,left:0}),fnFixPng(g),fnFixPng(h),h.css("opacity",0),g.hover(function(){g.hasClass("disabled")||h.stop().fadeTo(f,1)},function(){g.hasClass("active")||h.stop().fadeTo(f,0)})}!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a:a(jQuery)}(function(a){function b(b){var g=b||window.event,h=i.call(arguments,1),j=0,l=0,m=0,n=0,o=0,p=0;if(b=a.event.fix(g),b.type="mousewheel","detail"in g&&(m=-1*g.detail),"wheelDelta"in g&&(m=g.wheelDelta),"wheelDeltaY"in g&&(m=g.wheelDeltaY),"wheelDeltaX"in g&&(l=-1*g.wheelDeltaX),"axis"in g&&g.axis===g.HORIZONTAL_AXIS&&(l=-1*m,m=0),j=0===m?l:m,"deltaY"in g&&(m=-1*g.deltaY,j=m),"deltaX"in g&&(l=g.deltaX,0===m&&(j=-1*l)),0!==m||0!==l){if(1===g.deltaMode){var q=a.data(this,"mousewheel-line-height");j*=q,m*=q,l*=q}else if(2===g.deltaMode){var r=a.data(this,"mousewheel-page-height");j*=r,m*=r,l*=r}if(n=Math.max(Math.abs(m),Math.abs(l)),(!f||f>n)&&(f=n,d(g,n)&&(f/=40)),d(g,n)&&(j/=40,l/=40,m/=40),j=Math[j>=1?"floor":"ceil"](j/f),l=Math[l>=1?"floor":"ceil"](l/f),m=Math[m>=1?"floor":"ceil"](m/f),k.settings.normalizeOffset&&this.getBoundingClientRect){var s=this.getBoundingClientRect();o=b.clientX-s.left,p=b.clientY-s.top}return b.deltaX=l,b.deltaY=m,b.deltaFactor=f,b.offsetX=o,b.offsetY=p,b.deltaMode=0,h.unshift(b,j,l,m),e&&clearTimeout(e),e=setTimeout(c,200),(a.event.dispatch||a.event.handle).apply(this,h)}}function c(){f=null}function d(a,b){return k.settings.adjustOldDeltas&&"mousewheel"===a.type&&b%120===0}var e,f,g=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],h="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],i=Array.prototype.slice;if(a.event.fixHooks)for(var j=g.length;j;)a.event.fixHooks[g[--j]]=a.event.mouseHooks;var k=a.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var c=h.length;c;)this.addEventListener(h[--c],b,!1);else this.onmousewheel=b;a.data(this,"mousewheel-line-height",k.getLineHeight(this)),a.data(this,"mousewheel-page-height",k.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var c=h.length;c;)this.removeEventListener(h[--c],b,!1);else this.onmousewheel=null;a.removeData(this,"mousewheel-line-height"),a.removeData(this,"mousewheel-page-height")},getLineHeight:function(b){var c=a(b),d=c["offsetParent"in a.fn?"offsetParent":"parent"]();return d.length||(d=a("body")),parseInt(d.css("fontSize"),10)||parseInt(c.css("fontSize"),10)||16},getPageHeight:function(b){return a(b).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})}),eval(function(a){for(var b="",c=0,d=function(a,b){for(var c=0,d=0;d<b;d++){c*=96;var e=a.charCodeAt(d);e>=32&&e<=127&&(c+=e-32)}return c};c<a.length;)if("`"!=a.charAt(c))b+=a.charAt(c++);else if("`"!=a.charAt(c+1)){var e=d(a.charAt(c+3),1)+5;b+=b.substr(b.length-d(a.substr(c+1,2),2)-e,e),c+=4}else b+="`",c+=2;return b}('(function (n,l,o,s){var D="vmousecancel",A=true,E=false,F="virtualMouseBindings",J` 0$TouchID",X` d#over ` q!down` $"move` /"up vclick` ?"out` I"`!@".split(" "),Y="clientX ` "!Y pageX pageY screenX ` "!Y` N(T=n.event.`"? Hooks?n` ",.props:[],O` H$` . .concat(T),G={},u=0,v=0,U=0,w=E,Q=[],I=E,N=E,P="addEventListener" in o,R=n(o),t1=1,d0=0,r0;n.`#r!={moveDistanceThreshold:10,`"} ` %0resetTimerDuration:1500};`$}$a0(a){while (a&&typeof a.original`!c !=="undefined"){a=` 2*;}return a;}`%y$Y0(a,b`%z!c=a.type,d,f,g,h,i,j,k,m,q;a=n.`"i (a);` @!=b;d` r,f`#f);if (c.search(/^(`&z |`%j )/)>-1){f=O;}if (d){for (k=f.length,h;k;){h=f[--k];a[h]=d[h];}` M ` p%`\'r (down|up)` {!` { &&!a.which){` ""=1`!*!`!M&touch/)!==-1){g=a0(d);c=g.` 5 es;i=g.changed`(? es;j=(c&&c`!e")?c[0]:((i&&i` +$i[0]:s)`"c j`"9"m=0,q=Y`"=";m<q;m++){h=Y[m`">"j`"?!`$>/s`%I var b={},c,d;`%S#){c=n.data(a,F);`#J d in c){`$& [d]){b[d]=b.hasV`*P!Binding=A;}}a=a.parentNode`%k$b`%i&X`%h\'`!$4`%6 &&(!b||c[b])){`&V%` o2null`&r&B(){N=E`\'$&r` - A`\'6&P0(){d0=0;Q`%o"=0;I=E;r()`\']&Q0(){B` &(u0(){t0();u=`)<"out(`).$(){u=0;P0();},`*<#.`)^-` |\'t0(`#e!u){clear` o#u);u=0;}`)1%S(a,b,c`)6!d`(F `&, [a])||(!c&&X0(b.target,a))){d=Y0(b,a);n` 1$).trigger(d)`*;$d`*9&C`%g&`%W#` n#J`&v!!I&&(!d0||d0!==b)`$w"=S("v"+`*L!,a`$o"`&&".isDefaultPr`*P ed()){a.p` )!` 6"()`)(#isPropag`#1 Stopp` J#stop` 1&` G\'Immediate` @7` 1/();}}`#e&i`(N&a0(a)`*5#`(_ if (b&&b`%}#==1){c=`#!#;d=s0(c`*$!d`(J-`&_ t1++;`):"c,J,d0);`&< Q0();w=E;var f`!0)[0];v=f.pageX;U` #"Y;S("`&L!over",a,d)` *%down` -"`"7\'o`%% if (N`)%$`#w!!w){S(D,a,s0`%5$));}w=A;u`\'^ `*7$h` Q0`#&.[0],c=w,d=`(5$moveDistanceThreshold,f=`!*\';w=w||(Math.abs(b`"V!-v)>d||` (*Y-U)>d`\' !w&&!c`" #f);}`"{$move"` /!`!~*D`"^0r()`$\' b`!L(,c`#l%up",a,b`(8"w`)_"`(+ click` 3&d&&d`\'u2c`&C"changedT`%)%Q.push({`&_ ID:d0,x:c.clientX,y` #$Y});I=A;}`"D%out`!V"w=E`$N+v`*;.,F),c`\']!){for (c in b`*#!b[c]`%f$A;}}}`%t"E`%J&R0(){`(c%Z0(f`(g!g="`(c start",h=f.substr(1);`&]"{setup:`)B$(a,`!5"!v0(this)){`(R"this,F,{})`&N!c`!~#` 3!);c[f]=A;G[f]=(G[f]||0)+1`)} ` 0 `)v R.bind(h,C0);}n` !` ,#R0`*#!P){G[g` b g` Y)g` Y)g,i0` W"`"H!end",D` &)`&_!h` @$scroll",o0`)a ,teardown`"X+--G[f]`&C!G[f]){R.un`!s\'`!e"--G[g` @$g` =\'`![!` O"`!?+` *(`!q$` E#`!Y)`#l"`$/!`*5 `#p(`\'k ){d[f]=E;}c`!_%`#L#`$g&c.r`)U Data(F`"` ;}`&Z var p0=0;p0<X.length;p0++){n.`([ .special[X[p0]]=Z0(` % `"d%o.addEventListener("`)T"`&>&`(##Q` ",c=`*H#,d,f,g,h,i,j`(5#d=a`)<#;f` #$Y;r0=n.`)8!.`*[ DistanceThreshold;g=c;while (g`("h=0;h<b;h++){i=Q[h];j=0`)E (g===c&&Math.abs(i.x-d)<r0` \'(y-f)<r0)||`*&"g,J)===i.`)1 ID){a.pr`#/ Default();a.stopPropagation(`)C$;}}g=g.parentNode`&w A);}})(jQuery,window,document);')),jQuery(document).ready(function(a){function p(b,c){b.hasClass("disabled")||(b.addClass("disabled"),b.stop().fadeTo(300,c),a("span",b).stop().fadeTo(300,0),b.css("cursor","default"))}function q(a){a.hasClass("disabled")&&(a.removeClass("disabled"),a.stop().fadeTo(300,1),a.css("cursor","pointer"))}function r(b,c){var d=b.offset(),e=a(".tooltip[rel='"+c+"']"),f=d.top-e.outerHeight()-3,g=d.left-e.width()/2+parseInt(b.width(),10)/4-1;return e.css({top:f,left:g}),e}function s(b,c){var d=a(".tooltip[rel='"+b+"'] span");d.text(c)}function t(){a(document).unbind(f),a(document).unbind(g)}function u(a,b,c,d){a.css({"font-family":b,color:c,"font-size":d+"px"})}function v(a,b){a.css({"-webkit-border-radius":b,"-moz-border-radius":b,"-o-border-radius":b,"border-radius":b})}function w(a,b,c,d){if("0"!=c&&0!=c){var e=y(b,c),f=z(b,c);a.css({"background-color":b,filter:e,background:f})}"none"!=d&&a.css({"background-image":"url("+d+")","background-repeat":"repeat"})}function x(a){d&&(a.get(0).onselectstart=function(){return!1}),a.get(0).onmousedown=function(a){a.preventDefault()}}function y(a,b){var c=parseInt(255*parseFloat(b,10)).toString(16),d="progid:DXImageTransform.Microsoft.gradient(startColorstr=#"+c+a.substring(1,3)+a.substring(3,5)+a.substring(5,7)+",endColorstr=#"+c+a.substring(1,3)+a.substring(3,5)+a.substring(5,7)+")";return d}function z(a,b){var c="rgba("+a.substring(1,3)+", "+a.substring(3,5)+", "+a.substring(5,7)+", "+b+")";return c}var b=a("body"),c=navigator.userAgent.match(/(iPad)|(iPhone)|(iPod)|(android)|(webOS)/i),d=jQuery.browser.msie,e="mousedown",f="mousemove",g="mouseup",h="mouseover",i="mouseout",j="click",k=10;c&&(k=15,e="vmousedown",f="vmousemove",g="vmouseup",h="vmouseover",i="vmouseout",j="vclick");var m,n,l=0,o=function(b){this.xml=b.xml,this.parameters=b,this.singleImage=!1,this.focusable=!0,this.oldImage=-1,this.currentImage=0,this.numImages,this.degrees=0,this.speedDeg=0,this.speedInc=0,this.speedDegDefault=0,this.dragging=!1,this.panning=!1,this.positionClickedX,this.degWhenClicked,this.currentX,this.oldDif,this.buttonsDisabledAlpha=.3,this.viewLeft=0,this.viewTop=0,this.currentWidth,this.currentHeight,this.zoomWhenPad=1,this.ease=5,this.inertia=1,this.mouse_wheel_function="zoom",this.mouse_wheel_speed=1,this.draggingZoomSlider=!1,this.draggingPlaybackSlider=!1,this.sliderWidth=0,this.playbackSliderWidth=0,this.maxZoom,this.minZoom,this.zoomEase,this.zoomSpeed,this.zoom=1,this.zoomCurrent=1,this.focusTimer,this.focused=!1,this.autoplay=!1,this.autoplaySpeed,this.mode="rotate",this.reverse=!1,this.width=parseInt(this.parameters.width,10),this.height=parseInt(this.parameters.height,10),this.iniWidth,this.iniHeight,this.posX=0,this.posY=0,this.include_zoom_window=!1,this.zoom_window_width,this.zoom_window_height,this.zoomWindowEnabled=!0,this.viewLeftCurrent=0,this.viewTopCurrent=0,this.paddingEase=5,this.imagesPath,this.imagesBigPath,this.hotspotsImagesPath,this.grab_hand_cursor=!1,this.loading_text,this.imagesSrc=Array(),this.hotspots=Array(),this.hotspotsButtons=Array(),this.hotspotsTooltips=Array(),this.$hotspotsSmall,this.images=Array(),this.zoom_window_images=Array(),this.controls=Array(),this.controlsExtras=Array(),this.include_tooltips=!1,this.panel_options=Object(),this.loading_options=new Object,this.tooltips_options=new Object,this.zoom_window_options=new Object,this.tooltips_texts=new Object,this.$bigImage=null,this.$zoomSlider=null,this.$zoomMinus=null,this.$zoomPlus=null,this.$playbackSlider=null,this.$panButton=null,this.$rotateButton=null,this.$root=a(b.where),this.$main=a("<div></div>"),this.$view=a("<div></div>"),this.$imagesHolder=a("<div></div>"),this.$bigContent=a("<div></div>"),this.$panel=a("<div></div>"),this.$loader=a("<div></div>"),this.$zoomWindow,this.$zoomWindowBox,this.$zoomClickable,this.$loadingText=a("<div></div>"),this.$autoplayPlay,this.$autoplayPause,this.sliderFrom,this.sliderTo,this.sliderX,this.posIniX,this.posIniY,this.zoomBtnInterval=0,this.goToDegree=!1,this.showedHotspots=!1,this.focusedNum=-1,this.smallTweenTime=200,this.currentHotspots=Array(),this.currentHotspotsTooltips=Array()};o.prototype={_this:this,loadXml:function(){var b=this;a.ajax({type:"GET",url:b.xml,dataType:"xml",success:function(a){b.parseXml(a)}})},parseXml:function(b){var c=this,d=a(b).find("ProductViewer");this.ease=parseFloat(a(d).find("ease").text(),10),this.paddingEase=parseFloat(a(d).find("padding_ease").text(),10),this.inertia=parseFloat(a(d).find("inertia").text(),10),this.mouse_wheel_function=a(d).find("mouse_wheel_function").text(),this.mouse_wheel_speed=parseFloat(a(d).find("mouse_wheel_speed").text(),10),this.zoomSpeed=parseFloat(a(d).find("zoomSpeed").text(),10),this.zoomEase=parseInt(a(d).find("zoomEase").text(),10),"auto"==a(d).find("maxZoom").text()?this.maxZoom="auto":this.maxZoom=parseFloat(a(d).find("maxZoom").text(),10),"true"==a(d).find("reverse").text()&&(this.reverse=!0),"true"==a(d).find("autoplay").text()&&(this.autoplay=!0),"true"==a(d).find("grab_hand_cursor").text()&&(this.grab_hand_cursor=!0),this.autoplaySpeed=parseInt(a(d).find("autoplaySpeed").text(),10),"true"==a(d).find("include_tooltips").text()&&(this.include_tooltips=!0),"true"==a(d).find("include_zoom_window").text()&&(this.include_zoom_window=!0);var e=a(d).find("panel");this.panel_options.width=parseInt(a(e).find("width").text(),10),this.panel_options.height=parseInt(a(e).find("height").text(),10),this.panel_options.xOffset=parseInt(a(e).find("xOffset").text(),10),this.panel_options.yOffset=parseInt(a(e).find("yOffset").text(),10),this.panel_options.background_color=a(e).find("background_color").text(),this.panel_options.background_alpha=a(e).find("background_alpha").text(),this.panel_options.background_pattern=a(e).find("background_pattern").text(),this.panel_options.round_corners=a(e).find("round_corners").text()+"px",this.panel_options.show=a(e).find("show").text(),this.panel_options.buttons_side_margin=parseInt(a(e).find("buttons_side_margin").text(),10),this.panel_options.buttons_tween_time=parseInt(a(e).find("buttons_tween_time").text(),10),this.panel_options.ui_folder=a(e).find("ui_folder").text(),this.panel_options.buttons_width=parseInt(a(e).find("buttons_width").text(),10),this.panel_options.buttons_height=parseInt(a(e).find("buttons_height").text(),10),this.panel_options.divider_width=parseInt(a(e).find("divider_width").text(),10),this.panel_options.divider_height=parseInt(a(e).find("divider_height").text(),10),this.panel_options.slider_width=a(e).find("slider_width").text(),this.panel_options.slider_height=parseInt(a(e).find("slider_height").text(),10),this.panel_options.slider_background_color=a(e).find("slider_background_color").text(),this.panel_options.slider_background_alpha=a(e).find("slider_background_alpha").text(),this.panel_options.slider_background_pattern=a(e).find("slider_background_pattern").text(),this.panel_options.slider_round_corners=a(e).find("slider_round_corners").text()+"px",this.panel_options.zoom_subbuttons_width=parseInt(a(e).find("zoom_subbuttons_width").text(),10),this.panel_options.zoom_subbuttons_height=parseInt(a(e).find("zoom_subbuttons_height").text(),10),this.panel_options.zoom_subbuttons_distance=parseInt(a(e).find("zoom_subbuttons_distance").text(),10),this.panel_options.dragger_width=parseInt(a(e).find("dragger_width").text(),10),this.panel_options.dragger_height=parseInt(a(e).find("dragger_height").text(),10);var f=a(d).find("loading");this.loading_text=a(f).find("loading_text").text(),this.loading_options.background_color=a(f).find("background_color").text(),this.loading_options.background_alpha=a(f).find("background_alpha").text(),this.loading_options.background_pattern=a(f).find("background_pattern").text(),this.loading_options.text_font=a(f).find("text_font").text(),this.loading_options.text_size=a(f).find("text_size").text(),this.loading_options.text_color=a(f).find("text_color").text(),this.loading_options.text_span_color=a(f).find("text_span_color").text(),this.loading_options.text_background_color=a(f).find("text_background_color").text(),this.loading_options.text_background_alpha=a(f).find("text_background_alpha").text(),this.loading_options.text_background_pattern=a(f).find("text_background_pattern").text(),this.loading_options.text_background_round_corner=a(f).find("text_background_round_corner").text()+"px";var g=a(d).find("controls");a(g).find("control").each(function(b){var d=a(this);"hyperlink"==d.text()?c.controlsExtras.push(d.attr("href")):c.controlsExtras.push("none"),c.controls.push(d.text())});var h=a(d).find("tooltips_texts");this.tooltips_texts.rotate=a(h).find("rotate").text(),this.tooltips_texts.pan=a(h).find("pan").text(),this.tooltips_texts.rotate_slider=a(h).find("rotate_slider").text(),this.tooltips_texts.rotate_left=a(h).find("rotate_left").text(),this.tooltips_texts.rotate_right=a(h).find("rotate_right").text(),this.tooltips_texts.reset=a(h).find("reset").text(),this.tooltips_texts.zoom_slider=a(h).find("zoom_slider").text(),this.tooltips_texts.zoom_in=a(h).find("zoom_in").text(),this.tooltips_texts.zoom_out=a(h).find("zoom_out").text(),this.tooltips_texts.hyperlink=a(h).find("hyperlink").text(),this.tooltips_texts.play=a(h).find("play").text(),this.tooltips_texts.pause=a(h).find("pause").text();var i=a(d).find("tooltips");this.tooltips_options.text_font=a(i).find("text_font").text(),this.tooltips_options.text_size=a(i).find("text_size").text(),this.tooltips_options.text_color=a(i).find("text_color").text(),this.tooltips_options.left_right_padding=a(i).find("left_right_padding").text(),this.tooltips_options.top_bottom_padding=a(i).find("top_bottom_padding").text(),this.tooltips_options.background_color=a(i).find("background_color").text(),this.tooltips_options.background_alpha=a(i).find("background_alpha").text(),this.tooltips_options.round_corners=a(i).find("round_corners").text()+"px",this.tooltips_options.fadeTime=parseInt(a(i).find("fadeTime").text(),10);var j=a(d).find("zoom_window");this.zoom_window_options.window_width=a(j).find("window_width").text(),this.zoom_window_options.window_height=a(j).find("window_height").text(),this.zoom_window_options.background_color=a(j).find("background_color").text(),this.zoom_window_options.background_alpha=a(j).find("background_alpha").text(),this.zoom_window_options.background_pattern=a(j).find("background_pattern").text(),this.zoom_window_options.padding=a(j).find("padding").text(),this.zoom_window_options.selection_line_color=a(j).find("selection_line_color").text(),this.zoom_window_options.selection_line_alpha=a(j).find("selection_line_alpha").text(),void 0!=this.parameters.imagesPath&&(this.imagesPath=this.parameters.imagesPath),void 0!=this.parameters.imagesBigPath&&(this.imagesBigPath=this.parameters.imagesBigPath),"none"==this.imagesBigPath&&(this.focusable=!1),this.imagesArraySrc=this.parameters.imgArray,this.imagesArraySrcBig=this.parameters.imgArrayBig,this.imagesSrc=this.parameters.imgArrayName,1==this.imagesArraySrc.length&&(this.singleImage=!0),this.makeView()},makeView:function(){var b=this.panel_options.height+this.panel_options.yOffset;if(b<0&&(b=0),this.$main.css({position:"relative",width:this.width+"px",height:this.height+b+"px",margin:"0",padding:"0",top:"0",left:"0","text-align":"center"}),this.$bigContent.css({position:"absolute"}),this.$imagesHolder.css({position:"absolute"}),this.include_zoom_window){this.$zoomWindow=a("<div></div>"),this.$zoomWindowBox=a("<div></div>"),this.$zoomClickable=a("<div></div>");var d=a("<div></div>");this.$zoomWindow.css({position:"absolute",top:"5px",left:"5px",padding:this.zoom_window_options.padding+"px",opacity:"0",display:"none"}),this.$zoomClickable.css({width:"100%",height:"100%",position:"absolute"}),this.$zoomWindowBox.css({position:"absolute",border:"solid 1px "+this.zoom_window_options.selection_line_color,opacity:this.zoom_window_options.selection_line_alpha}),d.css({width:"100%",height:"100%","background-color":"#ffffff",opacity:"0"}),this.$zoomWindowBox.append(d),this.$zoomWindow.append(this.$zoomClickable,this.$zoomWindowBox),w(this.$zoomWindow,this.zoom_window_options.background_color,this.zoom_window_options.background_alpha,this.zoom_window_options.background_pattern)}this.$view.css({position:"relative",width:"100%",height:this.height+"px",overflow:"hidden"}),this.$panel.css({position:"absolute",width:this.panel_options.width+"px",height:this.panel_options.height+"px",top:this.height+parseInt(this.panel_options.yOffset,10)+"px",left:(this.width-this.panel_options.width)/2+parseInt(this.panel_options.xOffset,10)+"px"}),w(this.$panel,this.panel_options.background_color,this.panel_options.background_alpha,this.panel_options.background_pattern),v(this.$panel,this.panel_options.round_corners),this.$loader.css({zoom:"1",position:"absolute",width:"100%",height:"100%","text-align":"center",top:0,left:0}),this.$loadingText.css({padding:"8px 20px",position:"relative",top:this.height/2-20+"px",display:"inline-block"}),v(this.$loadingText,this.loading_options.text_background_round_corner),w(this.$loader,this.loading_options.background_color,this.loading_options.background_alpha,this.loading_options.background_pattern),w(this.$loadingText,this.loading_options.text_background_color,this.loading_options.text_background_alpha,this.loading_options.text_background_pattern),u(this.$loadingText,this.loading_options.text_font,this.loading_options.text_color,this.loading_options.text_size);for(var f=0;f<this.controls.length;f++){if("left"==this.controls[f]||"right"==this.controls[f]||"rotate"==this.controls[f]||"pan"==this.controls[f]||"hyperlink"==this.controls[f]||"reset"==this.controls[f]||"zoom-in"==this.controls[f]||"zoom-out"==this.controls[f]){var g=a('<a href="#"></a>').appendTo(this.$panel);if(g.css({position:"relative",float:"left",margin:this.panel_options.height/2-this.panel_options.buttons_height/2+"px "+this.panel_options.buttons_side_margin+"px",width:this.panel_options.buttons_width+"px",height:this.panel_options.buttons_height+"px",top:0,left:0}),buttonsClass(g,this.panel_options.ui_folder+this.controls[f]+"_out.png",this.panel_options.ui_folder+this.controls[f]+"_over.png",this.panel_options.buttons_width,this.panel_options.buttons_height,this.panel_options.buttons_tween_time),x(g),g.click(function(){return!1}),this.include_tooltips){var h=this.getHint(this.controls[f]);this.makeTooltip(h,g,f)}"left"==this.controls[f]?g.bind(e,a.proxy(this.leftControlDown,this)):"right"==this.controls[f]?g.bind(e,a.proxy(this.rightControlDown,this)):"rotate"==this.controls[f]?(this.$rotateButton=g,g.bind(j,a.proxy(this.changeToRotate,this))):"pan"==this.controls[f]?(this.$panButton=g,g.bind(j,a.proxy(this.changeToPan,this))):"reset"==this.controls[f]?g.bind(j,a.proxy(this.resetControlClick,this)):"zoom-out"==this.controls[f]?g.bind(j,a.proxy(this.zoomoutControlClick,this)):"zoom-in"==this.controls[f]?g.bind(j,a.proxy(this.zoominControlClick,this)):"hyperlink"==this.controls[f]&&(g.attr("href",this.controlsExtras[f]),g.attr("target","_blank"),g.unbind("click"),g.click(function(){return!0}))}else if("zoom-slider"==this.controls[f]){var k=a("<div></div>"),l=Math.max(this.panel_options.slider_height,this.panel_options.dragger_height);k.css({position:"relative",float:"left",height:l,margin:this.panel_options.height/2-l/2+"px "+this.panel_options.zoom_subbuttons_distance+"px",top:0,left:0});var m=a('<a href="#"></a>');buttonsClass(m,this.panel_options.ui_folder+"minus_out.png",this.panel_options.ui_folder+"minus_over.png",this.panel_options.zoom_subbuttons_width,this.panel_options.zoom_subbuttons_height,this.panel_options.buttons_tween_time);var n=a('<a href="#"></a>');buttonsClass(n,this.panel_options.ui_folder+"plus_out.png",this.panel_options.ui_folder+"plus_over.png",this.panel_options.zoom_subbuttons_width,this.panel_options.zoom_subbuttons_height,this.panel_options.buttons_tween_time);var o=a('<a href="#"></a>');buttonsClass(o,this.panel_options.ui_folder+"slider_out.png",this.panel_options.ui_folder+"slider_over.png",this.panel_options.dragger_width,this.panel_options.dragger_height,this.panel_options.buttons_tween_time);var p=a('<a href="#"></a>');if("auto"==this.panel_options.slider_width?this.sliderWidth=this.panel_options.width-((this.controls.length-1)*(this.panel_options.buttons_width+2*this.panel_options.buttons_side_margin)+2*this.panel_options.zoom_subbuttons_width+2*this.panel_options.buttons_side_margin+2*this.panel_options.zoom_subbuttons_distance+this.panel_options.divider_width*(this.controls.length-1)+1):this.sliderWidth=parseInt(this.panel_options.slider_width,10),p.css({position:"absolute",width:this.sliderWidth,height:this.panel_options.slider_height,top:l/2-this.panel_options.slider_height/2,left:"0"}),v(p,this.panel_options.slider_round_corners),w(p,this.panel_options.slider_background_color,this.panel_options.slider_background_alpha,this.panel_options.slider_background_pattern),m.css({position:"relative",float:"left",width:this.panel_options.zoom_subbuttons_width,height:this.panel_options.zoom_subbuttons_height,margin:this.panel_options.height/2-this.panel_options.zoom_subbuttons_height/2+"px 0px","margin-left":this.panel_options.buttons_side_margin}),n.css({position:"relative",float:"left",width:this.panel_options.zoom_subbuttons_width,height:this.panel_options.zoom_subbuttons_height,margin:this.panel_options.height/2-this.panel_options.zoom_subbuttons_height/2+"px 0px","margin-right":this.panel_options.buttons_side_margin}),o.css({position:"absolute",left:-this.panel_options.dragger_width/2+"px",width:this.panel_options.dragger_width}),k.css({width:this.sliderWidth}),k.append(p,o),this.$panel.append(m,k,n),this.$zoomSlider=o,this.$zoomMinus=m,this.$zoomPlus=n,o.click(function(){return!1}),x(n),x(m),x(o),this.sliderFrom=-this.panel_options.dragger_width/2,this.sliderTo=this.sliderWidth-this.panel_options.dragger_width/2,n.click(a.proxy(this.zoomPlusControlClick,this)),n.bind(e,a.proxy(this.zoomPlusControlDown,this)),m.click(a.proxy(this.zoomMinusControlClick,this)),m.bind(e,a.proxy(this.zoomMinusControlDown,this)),o.bind(e,a.proxy(this.zoomSliderDown,this)),p.click(a.proxy(this.zoomBackClick,this)),this.include_tooltips){var h="Zoom 0%";this.makeTooltip(h,o,"zoom-slider",[m,n])}}else if("playback-slider"==this.controls[f]){var q=a("<div></div>"),r=Math.max(this.panel_options.slider_height,this.panel_options.dragger_height);q.css({position:"relative",float:"left",height:r,margin:this.panel_options.height/2-r/2+"px "+this.panel_options.buttons_side_margin+"px",top:0,left:0});var o=a('<a href="#"></a>');buttonsClass(o,this.panel_options.ui_folder+"slider_out.png",this.panel_options.ui_folder+"slider_over.png",this.panel_options.dragger_width,this.panel_options.dragger_height,this.panel_options.buttons_tween_time);var p=a('<a href="#"></a>');"auto"==this.panel_options.slider_width?this.playbackSliderWidth=this.panel_options.width-((this.controls.length-1)*(this.panel_options.buttons_width+2*this.panel_options.buttons_side_margin)+2*this.panel_options.buttons_side_margin+this.panel_options.divider_width*(this.controls.length-1)+1):this.playbackSliderWidth=parseInt(this.panel_options.slider_width,10);a("<div></div>");if(p.css({position:"absolute",width:this.playbackSliderWidth,height:this.panel_options.slider_height,top:r/2-this.panel_options.slider_height/2,left:"0"}),v(p,this.panel_options.slider_round_corners),w(p,this.panel_options.slider_background_color,this.panel_options.slider_background_alpha,this.panel_options.slider_background_pattern),o.css({position:"absolute",left:-this.panel_options.dragger_width/2+"px"}),q.css({width:this.playbackSliderWidth}),q.append(p,o),this.$panel.append(q),this.$playbackSlider=o,o.click(function(){return!1}),x(o),this.sliderFrom=-this.panel_options.dragger_width/2,this.sliderTo=this.playbackSliderWidth-this.panel_options.dragger_width/2,o.bind(e,a.proxy(this.playbackSliderDown,this)),p.bind(j,a.proxy(this.playbackBackClick,this)),this.include_tooltips){var h="Rotate 0";this.makeTooltip(h,this.$playbackSlider,"playback-slider")}}else if("autoplay"==this.controls[f]){var g=a("<div></div>");g.css({position:"relative",float:"left",margin:this.panel_options.height/2-this.panel_options.buttons_height/2+"px "+this.panel_options.buttons_side_margin+"px",width:this.panel_options.buttons_width+"px",height:this.panel_options.buttons_height+"px",overflow:"hidden",top:0,left:0});var t=a('<a href="#"></a>');buttonsClass(t,this.panel_options.ui_folder+"play_out.png",this.panel_options.ui_folder+"play_over.png",this.panel_options.buttons_width,this.panel_options.buttons_height,this.panel_options.buttons_tween_time);var y=a('<a href="#"></a>');if(buttonsClass(y,this.panel_options.ui_folder+"pause_out.png",this.panel_options.ui_folder+"pause_over.png",this.panel_options.buttons_width,this.panel_options.buttons_height,this.panel_options.buttons_tween_time),t.css({position:"absolute",top:"0",left:"0"}),y.css({position:"absolute",top:"0",left:"0"}),g.append(t,y),this.$panel.append(g),this.$autoplayPlay=t,this.$autoplayPause=y,this.autoplay?t.stop().fadeTo(0,0).css("display","none"):y.stop().fadeTo(0,0).css("display","none"),g.click(a.proxy(this.autoplayClick,this)),this.include_tooltips){var h=this.tooltips_texts.play;this.autoplay&&(h=this.tooltips_texts.pause);this.makeTooltip(h,g,"autoplay")}}if(f!=this.controls.length-1){var z=a("<div></div>");z.css({position:"relative",float:"left",margin:this.panel_options.height/2-this.panel_options.divider_height/2+"px 0px",width:this.panel_options.divider_width,height:this.panel_options.divider_height}),z.append('<img src="'+this.panel_options.ui_folder+'divider.png" />'),this.$panel.append(z)}}if("none"!=this.mouse_wheel_function&&this.$view.mousewheel(a.proxy(this.mouseWheelControl,this)),this.$loader.append(this.$loadingText),this.$view.append(this.$imagesHolder,this.$zoomWindow,this.$bigContent),this.$main.append(this.$view),this.$main.append(this.$panel),this.$main.append(this.$loader),this.$root.append(this.$main),a("*",this.$main).bind(e,a.proxy(this.clearSmall,this)),a("*",this.$view).unbind(e),"roll_over"==this.panel_options.show&&!c){this.$panel.css("opacity","0");var A=this;this.$main.hover(function(){A.$panel.hasClass("blocked")||A.$panel.stop().fadeTo(500,1)},function(){A.$panel.stop().fadeTo(500,0)})}this.loadImage(0)},changeToRotate:function(){this.mode="rotate"},changeToPan:function(){this.mode="pan"},leftRightControlUp:function(){return this.autoplay?this.speedDegDefault=this.autoplaySpeed:this.speedDegDefault=0,a(document).unbind(g),!1},leftControlDown:function(){return this.speedDegDefault=7,a(document).bind(g,a.proxy(this.leftRightControlUp,this)),!1},rightControlDown:function(){return this.speedDegDefault=-7,a(document).bind(g,a.proxy(this.leftRightControlUp,this)),!1},resetControlClick:function(){this.zoom=this.minZoom,this.goToDegree=!0,this.goToDegreeNum=0},zoomoutControlClick:function(){return this.zoom=this.minZoom,!1},zoominControlClick:function(){return this.zoom=this.maxZoom,!1},zoomPlusControlClick:function(){return this.incrementZoom(),!1},zoomMinusControlClick:function(){return this.decrementZoom(),!1},incrementZoom:function(){this.zoom+=this.zoomSpeed},decrementZoom:function(){this.zoom-=this.zoomSpeed},zoomControlUp:function(){return clearInterval(this.zoomBtnInterval),this.changeFocus(),a(document).unbind(g),!1},zoomPlusControlDown:function(){return this.zoomBtnInterval=setInterval(a.proxy(this.incrementZoom,this),100),a(document).bind(g,a.proxy(this.zoomControlUp,this)),!1},zoomMinusControlDown:function(){return this.zoomBtnInterval=setInterval(a.proxy(this.decrementZoom,this),100),a(document).bind(g,a.proxy(this.zoomControlUp,this)),!1},zoomSliderMove:function(a){var b=a.pageX-this.posIniX,c=this.sliderX+b;c<this.sliderFrom&&(c=this.sliderFrom),c>this.sliderTo&&(c=this.sliderTo),this.$zoomSlider.css({left:c+"px"});var d=(c+this.panel_options.dragger_width/2)/this.sliderWidth;this.zoom=d*(this.maxZoom+(1-this.minZoom)-1)+1,this.zoomCurrent=this.zoom},zoomSliderUp:function(){return this.draggingZoomSlider=!1,t(),!1},zoomSliderDown:function(b){return this.posIniX=b.pageX,this.sliderX=parseInt(this.$zoomSlider.css("left"),10),this.draggingZoomSlider=!0,a(document).bind(f,a.proxy(this.zoomSliderMove,this)),a(document).bind(g,a.proxy(this.zoomSliderUp,this)),!1},zoomBackClick:function(b){var c=a(b.target).offset(),d=b.pageX-c.left-this.panel_options.dragger_width/2-3;d<this.sliderFrom&&(d=this.sliderFrom),d>this.sliderTo&&(d=this.sliderTo);var e=(d+this.panel_options.dragger_width/2)/this.sliderWidth;return this.zoom=e*(this.maxZoom-this.minZoom)+1,!1},playbackSliderMove:function(a){var b=a.pageX-this.posIniX,c=this.sliderX+b;c<this.sliderFrom&&(c=this.sliderFrom),c>this.sliderTo&&(c=this.sliderTo),this.$playbackSlider.css({left:c+"px"});var d=(c+this.panel_options.dragger_width/2)/this.playbackSliderWidth;this.goToDegree=!0,this.goToDegreeNum=Math.round(360*d)},playbackSliderUp:function(a){return this.draggingPlaybackSlider=!1,t(),!1},playbackSliderDown:function(b){return this.posIniX=b.pageX,this.sliderX=parseInt(this.$playbackSlider.css("left"),10),this.draggingPlaybackSlider=!0,this.goToDegreeNum=this.degrees,a(document).bind(f,a.proxy(this.playbackSliderMove,this)),a(document).bind(g,a.proxy(this.playbackSliderUp,this)),!1},playbackBackClick:function(b){var c=a(b.target).offset(),d=b.pageX-c.left-this.panel_options.dragger_width/2-3;
d<this.sliderFrom&&(d=this.sliderFrom),d>this.sliderTo&&(d=this.sliderTo);var e=(d+this.panel_options.dragger_width/2)/this.playbackSliderWidth;return this.goToDegree=!0,this.goToDegreeNum=Math.round(360*e),!1},autoplayClick:function(){var a=this;return this.autoplay?(s("autoplay",this.tooltips_texts.play),this.autoplay=!1,this.speedDegDefault=0,this.$autoplayPlay.stop().css("display","block").fadeTo(this.panel_options.buttons_tween_time,1),this.$autoplayPause.stop().fadeTo(this.panel_options.buttons_tween_time,0,function(){a.$autoplayPause.css("display","none")})):(s("autoplay",this.tooltips_texts.pause),this.autoplay=!0,this.speedDegDefault=this.autoplaySpeed,this.$autoplayPause.stop().css("display","block").fadeTo(this.panel_options.buttons_tween_time,1),this.$autoplayPlay.stop().fadeTo(this.panel_options.buttons_tween_time,0,function(){a.$autoplayPlay.css("display","none")})),r(this.$autoplayPlay,"autoplay"),!1},mouseWheelControl:function(a,b){return this.clearSmall(),"zoom"==this.mouse_wheel_function?this.zoom+=b*this.mouse_wheel_speed:"rotate"==this.mouse_wheel_function&&(this.speedDeg+=b*this.mouse_wheel_speed),!1},loadImage:function(b){var c=new Image,d=this;c.onload=function(){if(0==b){var f=c.width,g=c.height;if(f!=d.width||g!=d.height){var h=f/d.width;h>g/d.height&&(h=g/d.height),d.iniWidth=f/h,d.iniHeight=g/h,d.zoom=1-(h-1),d.zoomCurrent=d.zoom}else d.iniWidth=f,d.iniHeight=g,d.zoom=1,d.zoomCurrent=d.zoom;if(d.minZoom=d.zoom,d.$imagesHolder.css({width:d.iniWidth+"px",height:d.iniHeight+"px"}),d.include_zoom_window){var h=1;if("auto"==d.zoom_window_options.window_width)h=g/d.zoom_window_options.window_height;else{if("auto"!=d.zoom_window_options.window_height)return void alert("Error on a zoom window parameter on the xml -> width OR height must be 'auto'");h=f/d.zoom_window_options.window_width}var i=Math.round(f/h),j=Math.round(g/h);d.$zoomWindow.css({width:i+"px",height:j+"px"}),d.zoom_window_width=i,d.zoom_window_height=j}}a(c).css({width:"100%",height:"100%"});var k=a("<div rel='"+b+"'></div>");if(k.css({position:"absolute",width:"100%",height:"100%"}),k.append(c),d.$imagesHolder.append(k),d.include_zoom_window){var l=k.clone().css({padding:d.zoom_window_options.padding+"px",width:"auto",height:"auto"}).prependTo(d.$zoomWindow);d.zoom_window_images.push(l)}d.images.push(k),k.bind(e,a.proxy(d.clearSmall,d)),b==d.imagesSrc.length-1?d.loadFinished():d.loadImage(++b)};var f=this.loading_text;f=f.replace("loaded_images",b+1),f=f.replace("total_images",this.imagesSrc.length),f=f.replace("#span#","<span style='color:"+this.loading_options.text_span_color+"'>"),f=f.replace("#spanEnd#","</span>"),this.$loadingText.html(f),c.src=this.imagesArraySrc[b]},loadFinished:function(){this.$loader.fadeOut(500),this.currentImage=0,this.numImages=this.imagesSrc.length,this.include_zoom_window&&(this.relativeExcessW=this.zoom_window_width/this.iniWidth*(this.iniWidth-this.width),this.relativeExcessH=this.zoom_window_height/this.iniHeight*(this.iniHeight-this.height)),this.updateImage(),this.autoplay&&(this.speedDegDefault=this.autoplaySpeed),this.dragAndDrop()},onRotateMove:function(a){c?m!=a.pageX&&l>2?this.currentX=a.pageX:l<=2&&(m=a.pageX,l++):this.currentX=a.pageX},onRotateUp:function(){this.grabHandOpen(this.$imagesHolder,this),this.dragging=!1,this.changeFocus(),t()},onPanMove:function(a){var b,d;c?m!=a.pageX&&n!=a.pageY&&l>2?(b=a.pageX,d=a.pageY):l<=2&&(m=a.pageX,n=a.pageY,b=this.panPrevX,d=this.panPrevY,l++):(b=a.pageX,d=a.pageY);var e=this.panPrevLeft+(this.panPrevX-b),f=this.panPrevTop+(this.panPrevY-d),g=(this.currentWidth-this.width)/2,h=(this.currentHeight-this.height)/2;e<-g&&(e=-g),e>g&&(e=g),f<-h&&(f=-h),f>h&&(f=h),this.viewLeft=e,this.viewTop=f},onPanUp:function(){return this.grabHandOpen(this.$imagesHolder,this),this.panning=!1,t(),!1},startDrag:function(b){return this.grabHandClose(this.$imagesHolder,this),l=0,"rotate"!=this.mode||this.singleImage?(this.panPrevX=b.pageX,this.panPrevY=b.pageY,this.panning=!0,this.panPrevLeft=this.viewLeft,this.panPrevTop=this.viewTop,this.zoomWhenPad=this.zoom,a(document).bind(f,a.proxy(this.onPanMove,this)),a(document).bind(g,a.proxy(this.onPanUp,this)),!1):(this.removeFocus(),this.positionClickedX=b.pageX,this.oldDif=0,this.degWhenClicked=this.degrees,this.currentX=this.positionClickedX,this.dragging=!0,a(document).bind(f,a.proxy(this.onRotateMove,this)),a(document).bind(g,a.proxy(this.onRotateUp,this)),!1)},dragAndDrop:function(){var b=this;x(this.$imagesHolder),this.$imagesHolder.hover(function(){b.grabHandOpen(b.$imagesHolder,b)},function(){b.$imagesHolder.css("cursor","auto")}),this.$imagesHolder.bind(e,a.proxy(this.startDrag,this)),this.include_zoom_window&&(x(this.$zoomWindowBox),this.$zoomWindowBox.hover(function(){b.grabHandOpen(b.$zoomWindowBox,b)},function(){b.$zoomWindowBox.css("cursor","auto")}),this.$zoomClickable.click(function(a){var c=a.pageX,d=a.pageY,e=b.$zoomWindow.offset(),f=(b.currentWidth-b.width)/2,g=(b.currentHeight-b.height)/2,h=parseInt(b.$zoomWindowBox.css("width"),10),i=parseInt(b.$zoomWindowBox.css("height"),10),j=-f+(c-e.left-h/2)*(b.width/h),k=-g+(d-e.top-i/2)*(b.height/i);j<-f&&(j=-f),j>f&&(j=f),k<-g&&(k=-g),k>g&&(k=g),b.viewLeft=j,b.viewTop=k}),b.$zoomWindowBox.bind(e,function(c){b.grabHandClose(b.$zoomWindowBox,b);var d=c.pageX,e=c.pageY;b.panning=!0;var h=b.viewLeft,i=b.viewTop;return b.zoomWhenPad=b.zoom,a(document).bind(f,function(a){var c=a.pageX,f=a.pageY,g=h-(d-c)*(b.width/parseInt(b.$zoomWindowBox.css("width"),10)),j=i-(e-f)*(b.height/parseInt(b.$zoomWindowBox.css("height"),10)),k=(b.currentWidth-b.width)/2,l=(b.currentHeight-b.height)/2;return g<-k&&(g=-k),g>k&&(g=k),j<-l&&(j=-l),j>l&&(j=l),b.viewLeft=g,b.viewTop=j,!1}),a(document).bind(g,function(a){return b.grabHandOpen(b.$imagesHolder,b),b.panning=!1,t(),!1}),!1}))},makeTooltip:function(c,e,f,g){function m(){if(!a(this).hasClass("disabled")){var b=r(e,f);b.stop().fadeTo(l.tooltips_options.fadeTime,1),d&&k.stop().fadeTo(l.tooltips_options.fadeTime,l.tooltips_options.background_alpha)}}function n(){if(!a(this).hasClass("removing")){var b=a(".tooltip[rel='"+f+"']");b.stop().fadeTo(l.tooltips_options.fadeTime,0),d&&k.stop().fadeTo(l.tooltips_options.fadeTime,0)}}var j=a('<div class="tooltip"><span>'+c+"</span></div>"),k=a("<div></div>");j.css({"-moz-font-feature-settings":"normal","-moz-font-language-override":"normal",display:"inline-block","pointer-events":"none",position:"absolute","text-align":"center","text-decoration":"none",padding:this.tooltips_options.top_bottom_padding+"px "+this.tooltips_options.left_right_padding+"px","background-color":this.tooltips_options.background_color,opacity:"0"}),k.css({float:"left",position:"absolute",top:"100%",left:"50%","margin-left":"-5px",width:"0px",height:"0px","border-left":"5px solid transparent","border-right":"5px solid transparent","border-top":"5px solid "+this.tooltips_options.background_color,opacity:this.tooltips_options.background_alpha}),u(j,this.tooltips_options.text_font,this.tooltips_options.text_color,this.tooltips_options.text_size),v(j,this.tooltips_options.round_corners),w(j,this.tooltips_options.background_color,this.tooltips_options.background_alpha,"none"),j.append(k),b.append(j),j.attr("rel",f),r(e,f);var l=this;return d&&(j.stop().fadeTo(0,0),k.stop().fadeTo(0,0)),e.bind(h,m),e.bind(i,n),null!=g&&a(g).each(function(){a(this).bind(h,m),a(this).bind(i,n)}),j},getHint:function(a){var b;switch(a){case"left":b=this.tooltips_texts.rotate_left;break;case"right":b=this.tooltips_texts.rotate_right;break;case"rotate":b=this.tooltips_texts.rotate;break;case"pan":b=this.tooltips_texts.pan;break;case"hyperlink":b=this.tooltips_texts.hyperlink;break;case"reset":b=this.tooltips_texts.reset;break;case"zoom-in":b=this.tooltips_texts.zoom_in;break;case"zoom-out":b=this.tooltips_texts.zoom_out;break;case"zoom_slider":var c=Math.round((this.zoom-this.minZoom)/(this.maxZoom-this.minZoom)*100)+"";b=this.tooltips_texts.zoom_slider,b=b.replace("zoom_number",c);break;case"rotate_slider":var d,e=this.degrees;this.degrees<0&&(e=360+this.degrees),d=this.draggingPlaybackSlider?Math.round(this.goToDegreeNum)+"":Math.round(e)+"",b=this.tooltips_texts.rotate_slider,b=b.replace("rotate_number",d)}return b},clearSmall:function(){null!=this.$hotspotsSmall&&(this.$hotspotsSmall.stop().fadeTo(this.smallTweenTime,0,function(){a(this).remove()}),this.$hotspotsSmall=null)},updateSmall:function(){null!=this.$hotspotsSmall&&this.$hotspotsSmall.css({left:parseInt(this.$smallHotspot.css("left"),10)-this.smallWidth/2,top:parseInt(this.$smallHotspot.css("top"),10)-this.smallHeight/2})},getHotspotButton:function(b,d){for(var f=this,h=-1,i=0;i<this.hotspotsButtons.length;i++)if(this.hotspotsButtons[i].id==b.id){h=i;break}if(h==-1)return null;var k=parseInt(this.hotspotsButtons[h].width,10),l=parseInt(this.hotspotsButtons[h].height,10),m=a("<a href='#' rel="+d+"></a>").css({position:"absolute","margin-left":Math.round(-k/2)+"px","margin-top":Math.round(-l/2)+"px"});if(buttonsClass(m,this.hotspotsImagesPath+this.hotspotsButtons[h].out,this.hotspotsImagesPath+this.hotspotsButtons[h].over,k,l,parseInt(this.hotspotsButtons[h].tweenTime,10)),"none"!=b.tooltip&&null!=b.tooltip){var n=b.tooltip,o=this.makeTooltip(n,m,"cont"+d);this.currentHotspotsTooltips.push(o)}return"link"==b.type&&(m.attr({href:b.content,target:"_blank"}),c&&m.bind(j,function(){return window.location=b.content,!1})),"small"==b.type?m.bind(j,function(){f.clearSmall();var c=b.content,d=a(this),h=a("<div></div>").css({width:c.width,position:"absolute",padding:c.padding+"px",opacity:"0"}).html(c.html);return v(h,c.round_corners),w(h,c.background_color,c.background_alpha,c.background_pattern),f.smallTweenTime=c.fadeTime,f.$imagesHolder.append(h.fadeTo(f.smallTweenTime,1)),f.$hotspotsSmall=h,f.$smallHotspot=d,f.smallWidth=c.width,f.smallHeight=h.outerHeight(),a("a",h).live(e,function(){return!0}),a("a",h).live(g,function(){return!0}),a("a",h).live(j,function(){return!0}),!1}):"big"==b.type&&m.bind(j,function(){var e=b.content,i=(a(this),a("<div></div>"));f.$bigContent.append(i),i.load(e.html),a.proxy(f.initScroll(i,f.width,f.height),f),i.css({width:"100%",position:"absolute",left:"0",top:"0"}),f.$bigContent.css({width:"100%",height:"100%",opacity:"0"}),w(f.$bigContent,e.background_color,e.background_alpha,e.background_pattern);for(var j=-1,k=0;k<f.hotspotsButtons.length;k++)if(f.hotspotsButtons[k].id==e.close_button_id){j=k;break}if(j==-1)return null;var l=parseInt(f.hotspotsButtons[j].width,10),m=parseInt(f.hotspotsButtons[j].height,10),n=a("<a href='#' rel="+d+"></a>").css({position:"absolute",left:f.width-l+e.closeOffsetX+"px",top:e.closeOffsetY+"px"});return buttonsClass(n,f.hotspotsImagesPath+f.hotspotsButtons[j].out,f.hotspotsImagesPath+f.hotspotsButtons[j].over,l,m,parseInt(f.hotspotsButtons[j].tweenTime,10)),f.$bigContent.append(n).stop().fadeTo(e.fadeTime,1),n.click(function(){return"roll_over"==f.panel_options.show&&f.$panel.removeClass("blocked").stop().fadeTo(500,1),f.$bigContent.stop().fadeTo(e.fadeTime,0,function(){a(this).empty().css({width:"0",height:"0"})}),!1}),"roll_over"==f.panel_options.show&&f.$panel.addClass("blocked").stop().fadeTo(500,0),!1}),m},clearHotspots:function(){for(var b=0;b<this.currentHotspots.length;b++)this.currentHotspots[b].addClass("disabled removing").stop().fadeTo(500,0,function(){a(this).remove()});for(var b=0;b<this.currentHotspotsTooltips.length;b++)this.currentHotspotsTooltips[b].stop().fadeTo(500,0,function(){a(this).remove()});this.currentHotspots=Array(),this.currentHotspotsTooltips=Array()},updateHotspots:function(){for(var a=0;a<this.currentHotspots.length;a++)if(null!=this.hotspots[this.currentImage]){var b=this.hotspots[this.currentImage][a];this.currentHotspots[a].css({left:Math.round(b.x*this.zoomCurrent)+"px",top:Math.round(b.y*this.zoomCurrent)+"px"}),r(this.currentHotspots[a],"cont"+this.currentHotspots[a].attr("rel"))}this.updateSmall()},bringHotspotsTimeout:function(){if(null!=this.hotspots[this.currentImage])for(var a=0;a<this.hotspots[this.currentImage].length;a++){var b=this.hotspots[this.currentImage][a],c=this.getHotspotButton(b,a).css({left:b.x+"px",top:b.y+"px",opacity:"0"}).fadeTo(500,1);null!=c&&(this.$imagesHolder.append(c),this.currentHotspots.push(c))}},bringHotspots:function(){clearTimeout(this.hotspotsTimer),null!=this.hotspots[this.currentImage]&&(this.hotspotsTimer=setTimeout(a.proxy(this.bringHotspotsTimeout,this),100))},getToFront:function(){if(this.currentImage>=0&&this.currentImage<this.numImages&&this.currentImage!=this.oldImage){for(var a=0;a<this.numImages;a++)this.images[a].css("display","none"),this.include_zoom_window&&this.zoom_window_images[a].css("display","none");this.images[this.currentImage].css("display","block"),this.include_zoom_window&&this.zoom_window_images[this.currentImage].css("display","block"),this.oldImage=this.currentImage,this.clearHotspots(),this.clearSmall(),this.bringHotspots(),this.changeFocus()}},removeFocus:function(){clearTimeout(this.focusTimer),this.focusing=!1,this.focused=!1,this.focusedNum=-1,null!=this.$bigImage&&this.$bigImage.remove()},changeFocus:function(){this.focusable&&(this.removeFocus(),this.zoom>1&&!this.dragging&&(this.focusTimer=setTimeout(a.proxy(this.updateFocus,this),500)))},updateFocus:function(){this.focusable&&(clearTimeout(this.focusTimer),this.focusing=!0,this.loadBigImage())},loadBigImage:function(){if(!this.dragging&&this.focusable){this.focused&&this.removeFocus();var b=new Image,c=this.currentImage,d=this;b.onload=function(){if(c==d.currentImage&&d.zoom>1){d.focused&&d.removeFocus(),d.focused=!0,d.focusing=!1,d.focusedNum=c;var e=d.images[c],f=a(b);f.css({top:"0",left:"0",width:"100%",height:"100%",position:"absolute"}),e.append(f),d.$bigImage=f}},b.src=this.imagesArraySrcBig[c]}},calculateDegree:function(){if(this.dragging||this.goToDegree||this.draggingPlaybackSlider){if(this.goToDegree){var a;a=this.draggingPlaybackSlider?this.goToDegreeNum-this.degrees:(this.goToDegreeNum-this.degrees)/this.ease,this.degrees+=a,Math.round(this.degrees)==this.goToDegreeNum&&(this.goToDegree=!1,this.degrees=Math.round(this.degrees))}}else{var a=(this.speedDegDefault-this.speedDeg)/this.ease;this.speedDeg+=a,this.degrees+=Math.round(this.speedDeg)}for(;this.degrees>360;)this.degrees-=360;for(;this.degrees<-360;)this.degrees+=360;var b=this.degrees;if(this.degrees<0&&(b=360+this.degrees),this.currentImage=Math.round(b/360*this.numImages),this.reverse&&0!=this.currentImage&&(this.currentImage=this.numImages-this.currentImage),this.getToFront(),null!=this.$playbackSlider&&(r(this.$playbackSlider,"playback-slider"),s("playback-slider",this.getHint("rotate_slider")),!this.draggingPlaybackSlider)){var c=Math.abs(b)/360,d=c*this.playbackSliderWidth-this.panel_options.dragger_width/2;this.$playbackSlider.css({left:d+"px"})}},calculateZoom:function(){this.zoom<this.minZoom&&(this.zoom=this.minZoom),this.zoom>this.maxZoom&&(this.zoom=this.maxZoom);var a=(this.zoom-this.zoomCurrent)/this.zoomEase;this.zoomCurrent+=a,this.currentWidth=Math.round(this.iniWidth*this.zoomCurrent),this.currentHeight=Math.round(this.iniHeight*this.zoomCurrent);var b=(this.currentWidth-this.width)/2,c=(this.currentHeight-this.height)/2;this.posX=Math.round(-b),this.posY=Math.round(-c),this.viewLeft+=this.viewLeft*(this.zoomCurrent-this.zoomWhenPad)/2,this.viewTop+=this.viewTop*(this.zoomCurrent-this.zoomWhenPad)/2,this.zoomWhenPad=this.zoomCurrent;var d=(this.viewLeft-this.viewLeftCurrent)/this.paddingEase,e=(this.viewTop-this.viewTopCurrent)/this.paddingEase;this.viewLeftCurrent+=d,this.viewTopCurrent+=e;var f=Math.round(this.posX-this.viewLeftCurrent),g=Math.round(this.posY-this.viewTopCurrent);if(f>0?(this.viewLeft=this.posX,f=0):f<2*-b&&(this.viewLeft=-this.posX,f=2*-b),g>0?(this.viewTop=this.posY,g=0):g<2*-c&&(this.viewTop=-this.posY,g=2*-c),(this.focused||this.focusing)&&this.zoom<=1?this.removeFocus():!this.focusing&&!this.focused&&this.zoom>1&&this.updateFocus(),this.$imagesHolder.css({width:this.currentWidth+"px",height:this.currentHeight+"px",left:f+"px",top:g+"px"}),this.include_zoom_window&&this.$zoomWindowBox.css({width:Math.round((this.zoom_window_width-this.relativeExcessW)/this.zoomCurrent)+"px",height:Math.round((this.zoom_window_height-this.relativeExcessH)/this.zoomCurrent)+"px",top:Math.round(-g*(this.zoom_window_height/this.currentHeight))+"px",left:Math.round(-f*(this.zoom_window_width/this.currentWidth))+"px"}),null!=this.$zoomSlider&&(r(this.$zoomSlider,"zoom-slider"),s("zoom-slider",this.getHint("zoom_slider")),!this.draggingZoomSlider)){var h=(this.zoomCurrent-this.minZoom)/(this.maxZoom-this.minZoom),i=h*this.sliderWidth-this.panel_options.dragger_width/2;this.$zoomSlider.css({left:i+"px"}),this.zoom==this.minZoom?p(this.$zoomMinus,this.buttonsDisabledAlpha):q(this.$zoomMinus,this.buttonsDisabledAlpha),this.zoom==this.maxZoom?p(this.$zoomPlus,this.buttonsDisabledAlpha):q(this.$zoomPlus,this.buttonsDisabledAlpha)}},updateImage:function(){if(this.singleImage?this.showedHotspots||(this.bringHotspots(),this.showedHotspots=!0):this.calculateDegree(),this.minZoom!=this.maxZoom&&Math.round(1e3*this.zoom)!=Math.round(100*this.zoomCurrent)&&this.calculateZoom(),this.updateHotspots(),this.dragging){var b=this.positionClickedX-this.currentX;c&&(b<20&&b>-20&&(b=0),b/=2);var d=b-this.oldDif;this.speedDeg=Math.round(d*this.inertia),this.oldDif=b,this.degrees=this.degWhenClicked+b}var e=!1,f=Math.round(this.iniWidth*this.zoom),g=Math.round(this.iniHeight*this.zoom);(f>this.width||g>this.height)&&(e=!0),this.include_zoom_window&&(e&&!this.zoomWindowEnabled?(this.$zoomWindow.css("display","block").stop().fadeTo(500,1),this.zoomWindowEnabled=!0):!e&&this.zoomWindowEnabled&&(this.$zoomWindow.stop().fadeTo(500,0,function(){a(this).css("display","none")}),this.zoomWindowEnabled=!1)),e||"pan"!=this.mode||(this.mode="rotate"),null!=this.$panButton&&("pan"!=this.mode&&e?q(this.$panButton,this.buttonsDisabledAlpha):p(this.$panButton,this.buttonsDisabledAlpha)),null!=this.$rotateButton&&("rotate"==this.mode?p(this.$rotateButton,this.buttonsDisabledAlpha):q(this.$rotateButton,this.buttonsDisabledAlpha)),setTimeout(a.proxy(this.updateImage,this),k)},grabHandOpen:function(a,b){b.grab_hand_cursor?a.css("cursor","url("+b.panel_options.ui_folder+"grabhand_open.png) 12 12,auto"):a.css("cursor","pointer")},grabHandClose:function(a,b){b.grab_hand_cursor?a.css("cursor","url("+b.panel_options.ui_folder+"grabhand_closed.png) 12 12,auto"):a.css("cursor","pointer")},initScroll:function(b,c,d){var h=b,i=this;x(b);var j=c,k=d;b.hover(function(){i.grabHandOpen(b,i)},function(){b.css("cursor","auto")}),b.bind(e,function(c){function p(){return i.grabHandOpen(h,i),t(),a(document).unbind("mouseout"),!1}i.grabHandClose(h,i);var d=c.pageX,e=c.pageY,l=parseInt(h.css("left"),10),m=parseInt(h.css("top"),10),n=h.width(),o=h.height();return a(document).bind(f,function(b){var c=b.pageX,f=b.pageY,g=l-(d-c),i=m-(e-f);return g>0?g=0:g<j-n&&(g=j-n),i>0?i=0:i<k-o&&(i=k-o),h.css({left:g,top:i}),!1}),a(document).bind(g,p),a(document).bind("mouseout",p),!1})}},Expo360=function(a){var b=new o(a);b.loadXml(),this.goTo=function(a){b.goToDegree=!0,b.goToDegreeNum=a},this.zoomTo=function(a){b.zoom=a}}});